<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Historic People - Master Edition</title>
    <style>
        body { font-family: -apple-system, sans-serif; background: #121212; color: #e0e0e0; margin: 0; padding: 0; overflow-x: hidden; }
        
        /* SPLASH SCREEN */
        #splash-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #121212; z-index: 10001; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .neon-ring { width: 350px; height: 350px; border-radius: 50%; border: 10px solid #ff0000; box-shadow: 0 0 40px #ff0000; display: flex; align-items: center; justify-content: center; animation: pulse 2s infinite; margin-bottom: 40px; overflow: hidden; background: #1a1a1a; }
        .logo-img { width: 100%; height: 100%; object-fit: cover; }
        @keyframes pulse { 0% { box-shadow: 0 0 20px #ff0000; } 50% { box-shadow: 0 0 60px #ff0000; } 100% { box-shadow: 0 0 20px #ff0000; } }
        #start-btn { padding: 25px 90px; font-size: 28px; font-weight: 900; color: white; background: linear-gradient(135deg, #d63031, #ff0000); border: none; border-radius: 60px; cursor: pointer; text-transform: uppercase; }

        /* HEADER AREA */
        #header-area { position: fixed; top: 0; width: 100%; background: #000; border-bottom: 2px solid #333; z-index: 100; padding: 15px 0; text-align: center; }
        #app-title { font-size: 24px; font-weight: 900; color: #fff; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 2px; }
        .toggle-btn { padding: 15px 40px; border-radius: 35px; border: none; font-weight: 900; cursor: pointer; color: #888; background: #222; margin: 0 10px; font-size: 18px; }
        .toggle-btn.active { color: #fff; background: #007AFF; }
        #audio-bar { display: flex; justify-content: center; align-items: center; gap: 15px; margin-top: 15px; }
        #player { height: 45px; width: 75%; outline: none; }
        #btn-snail { background: #111; color: white; border: 2px solid #ff0033; font-size: 28px; padding: 5px 20px; border-radius: 12px; cursor: pointer; }
        #btn-snail.active { border-color: #39ff14; box-shadow: 0 0 10px #39ff14; }

        /* CONTENT AREA */
        #content-area { padding: 20px; padding-top: 240px; max-width: 700px; margin: 0 auto; }
        .card { background: #1e1e1e; padding: 30px; margin-bottom: 30px; border-radius: 15px; border: 1px solid #333; }
        .card-title { font-size: 30px; font-weight: 900; color: #fff; margin-bottom: 25px; text-transform: capitalize; text-align: center; border-bottom: 1px solid #444; padding-bottom: 15px; }
        .listen-btn { padding: 22px; border-radius: 12px; border: none; cursor: pointer; font-weight: 900; font-size: 22px; color: white; display: block; width: 100%; margin-bottom: 15px; }
        .btn-uk { background: #d63031; } .btn-us-f { background: #e056fd; } .btn-us-m { background: #007AFF; }

        /* MODAL - 32PX FONT */
        #modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 3000; overflow-y: auto; }
        #modal-content { padding: 45px; max-width: 900px; margin: 0 auto; padding-top: 110px; }
        #close-btn { position: fixed; top: 30px; right: 30px; font-size: 40px; cursor: pointer; color: white; z-index: 3100; background: #ff0033; width: 70px; height: 70px; border-radius: 50%; border: none; }
        #story-text { font-size: 32px; line-height: 1.7; color: #f0f0f0; text-align: justify; font-weight: 500; white-space: pre-wrap; }

        /* QUIZ MENU - TOUCH FRIENDLY */
        .quiz-menu-btn { display: block; width: 100%; padding: 30px; background: #1e1e1e; border: 2px solid #333; color: white; font-weight: 900; border-radius: 15px; margin-bottom: 40px; cursor: pointer; text-align: left; font-size: 26px; text-transform: capitalize; min-height: 100px; }
        .quiz-q { background: #121212; padding: 35px; border-radius: 15px; margin-bottom: 35px; border-left: 12px solid #e056fd; }
        .q-text { font-size: 28px; font-weight: bold; color: #fff; margin-bottom: 30px; }
        .mcq-option { width: 100%; padding: 25px; background: #1e1e1e; border: 2px solid #333; color: #fff; border-radius: 12px; font-size: 24px; font-weight: bold; text-align: left; margin-bottom: 20px; cursor: pointer; }
        .feedback { font-weight: bold; display: block; margin-top: 25px; font-size: 30px; text-align: center; }
        .correct { color: #39ff14; } .wrong { color: #ff0033; }
    </style>
</head>
<body>

<div id="splash-screen">
    <div class="neon-ring"><img src="logo.png" class="logo-img" onerror="this.src='https://raw.githubusercontent.com/dogierez01/historic-people/main/logo.png'"></div>
    <button onclick="startApp()" id="start-btn">START üèõÔ∏è</button>
</div>

<div id="header-area">
    <div id="app-title">üèõÔ∏è HISTORIC PEOPLE</div>
    <div style="display:flex; justify-content:center;">
        <button id="btn-listen" class="toggle-btn active" onclick="setMode('listen')">üéß Listen</button>
        <button id="btn-quiz" class="toggle-btn" onclick="setMode('quiz')">üß† Quiz</button>
    </div>
    <div id="audio-bar">
        <audio id="player" controls controlsList="nodownload"></audio>
        <button id="btn-snail" onclick="toggleSnail()">üêå</button>
    </div>
</div>

<div id="content-area">
    <input type="text" id="search" style="width:100%; padding:20px; font-size:22px; border-radius:15px; border:1px solid #333; background:#1e1e1e; color:white; margin-bottom:30px; box-sizing:border-box;" placeholder="Search history heroes..." onkeyup="filterList()">
    <div id="list"></div>
</div>

<div id="modal">
    <button id="close-btn" onclick="closeModal()">‚úï</button>
    <div id="modal-content">
        <div id="view-listen"><div id="story-text"></div></div>
        <div id="view-quiz" style="display:none;"><h2 id="quiz-title" style="text-align:center; font-size: 38px;"></h2><div id="quiz-area"></div></div>
    </div>
</div>

<script>
    const db = [
        {
            title: "Alexander the Great", f: "alexander the great",
            text: "Alexander was born in 356 BC in Pella, the capital of Macedon. His mother, Olympia, was a strong and mysterious woman. She prayed to snakes and kept many of them in the palace. Alexander grew up with these snakes. Poisonous snakes bit him, so his body became strong against poison. His father, King Philip II, was a very strict ruler. One night, he punished Alexander very badly. This difficult event helped make Alexander a fearless and strong man. Even as a young man, Alexander was special. He did not have a beard. He ordered all his soldiers to shave their faces, too. This rule for soldiers is still used today. He was a student of the famous teacher Aristotle. He learned about war and how to lead an army. He became a commander when he was still a teenager. Alexander wanted to conquer the whole world. He took control of many huge lands like Persia and Egypt. He even traveled as far as India. His army grew bigger and stronger. However, great power brought danger. When he was at the River Indus, his own generals turned against him. They poisoned him because they were tired of fighting. They wanted to stop and return to their homes and families.",
            mcq: [{q:"How did Alexander shape his resistance to poison?", options:["Intense exercise", "Exposure to palace snakes", "Special diet"], a:1},{q:"What facial tradition did he start for soldiers?", options:["Grow beards", "Shave their faces", "Face paint"], a:1},{q:"Who was his famous teacher?", options:["Socrates", "Plato", "Aristotle"], a:2},{q:"River Indus event?", options:["Generals turn against him", "He built a city", "Naval victory"], a:0},{q:"Why poisoned?", options:["For gold", "Tired of fighting", "Spying"], a:1}]
        },
        {
            title: "Baltacƒ± Mehmet Pasha", f: "baltaci mehmet",
            text: "Baltacƒ± Mehmet Pasha was an Ottoman grand vizier in the early 18th century. He is best known for his role in the Prut War between the Ottoman Empire and Russia in 1711. At that time, Russia was growing stronger under Tsar Peter the Great. The Ottomans, with the help of the Crimean Tatars, marched to stop them. Baltacƒ± Mehmet Pasha led the Ottoman army to the Prut River, where they surrounded the Russian forces. The Russians were trapped, hungry, and weak. It seemed that the Ottomans were ready for a great victory. Although the army had the chance to destroy the Russians, Baltacƒ± Mehmet Pasha accepted peace. With the Treaty of Prut, Russia gave back the city of Azov and promised to stay away from Ottoman lands. Peter the Great and his army were allowed to leave safely. Some people praised Baltacƒ± Mehmet Pasha for avoiding more bloodshed. Others blamed him for not using the chance to defeat Russia completely. After this, his career lost strength, but the Treaty of Prut remained an important event in Ottoman history.",
            mcq: [{q:"Russian Tsar in 1711?", options:["Ivan IV", "Peter the Great", "Nicholas"], a:1},{q:"Returned city?", options:["Moscow", "Istanbul", "Azov"], a:2},{q:" Ottoman allies?", options:["Crimean Tatars", "British", "French"], a:0},{q:"Russian condition?", options:["Strong", "Trapped and weak", "Armed"], a:1},{q:"Career result?", options:["Sultan", "Lost strength", "Execution"], a:1}]
        },
        {
            title: "Mezamorta", f: "mezamorta",
            text: "Mezamorta H√ºseyin Pasha was a famous Ottoman admiral born in the 17th century. Some people say he was originally from Spain and later became a Muslim. He started his career as a sailor and a pirate in the Mediterranean Sea. His interesting nickname, 'Mezamorta,' means 'half-dead' in Italian. In a big battle against the Venetians, he was hurt very badly. His enemies thought he was dead, but he survived. Because of this amazing event, he got his famous name. By 1674, he was a captain and attacked many enemy ships. In 1683, the French navy attacked Algiers. The leader of Algiers wanted to give up, but Mezamorta refused. He became the new ruler and defended the city. To show his strength, he put the French consul into a large cannon and fired him at the enemy ships. This stopped the French attack. Later, he attacked the French coast until they agreed to peace. Later, Mezamorta went to Istanbul to join the Ottoman navy. In 1695, he won back Chios Island from the Venetians. Because of this victory, the Sultan made him the Grand Admiral, or 'Kapudan Pasha.' He changed how the navy fought. He stopped using old rowing ships and started using big sailing ships called 'kalyons.' Mezamorta died from an illness in 1701 while getting ready for a new war.",
            mcq: [{q:"Nickname meaning?", options:["Sea Lion", "Half-dead", "Warrior"], a:1},{q:"Stopping French?", options:["Burning fleet", "Consul fired from cannon", "Surrender"], a:1},{q:"Ship change?", options:["Rowing to kalyons", "Wood to iron", "Steam"], a:0},{q:"Chios enemy?", options:["French", "Venetians", "Spanish"], a:1},{q:"Start?", options:["Pirate/Sailor", "Farmer", "Prince"], a:0}]
        },
        {
            title: "Ragnar Lodbrok", f: "ragnar lodbrok",
            text: "Ragnar Lodbrok was a famous Viking leader who lived in the 9th century. He came from Scandinavia and led many attacks on England and France. Ragnar became well known for his brave fighting and smart battle plans. Stories say he got his name 'Lodbrok' by wearing special pants to protect himself from a poisonous snake. He led many successful Viking journeys. In 845, he attacked Paris with a large group of Viking ships. The French king paid him a great amount of silver to leave the city. This made Ragnar very wealthy and increased his fame. Ragnar had several sons who also became famous Viking warriors. Their names were Ivar the Boneless, Bjorn Ironside, and Halfdan Ragnarsson. These sons later led the Great Heathen Army in England. Ragnar died during an attack on England. King Aella of Northumbria captured him and put him in a snake pit as punishment. Before he died, Ragnar said that his sons would punish King Aella for killing him. His sons kept this promise. They attacked England, captured King Aella, and killed him to avenge their father's death.",
            mcq: [{q:"Name meaning?", options:["Hairy pants", "Fast boat", "King"], a:0},{q:"Paris 845?", options:["Defeat", "Silver payment", "Crowned King"], a:1},{q:"Death?", options:["Battle", "Snake pit", "Old age"], a:1},{q:"Sons group?", options:["Heathen Army", "Legion", "Akƒ±ncƒ±"], a:0},{q:"Vengeance on?", options:["Nero", "King Aella", "Eugene"], a:1}]
        },
        {
            title: "Salahuddin Eyyubi", f: "salahuddin eyyubi",
            text: "Salahuddin Ayyubi, also known as Saladin, was born in 1137 in Tikrit, Iraq. He came from a family of soldiers and learned about war when he was very young. He served his uncle, Shirkuh, who taught him how to be a leader. Later, Salahuddin became the ruler of Egypt after he won an important battle. Salahuddin had a strong faith in Islam. At that time, many Muslim rulers fought against each other. Salahuddin worked hard to stop this and bring all Muslim lands together. His main goal was to defend his people against the Crusader armies from Europe. His most famous moment happened in 1187 at the Battle of Hattin. His army won a huge victory against the Crusaders. After this battle, he captured the holy city of Jerusalem. He was a fair man. He treated the people in the city with kindness and respect. He let Christians and Jews stay in peace or leave safely if they wanted. After this victory, he protected Jerusalem from new attacks. He continued to lead his army until he died in 1193. Today, history remembers Salahuddin as a great hero who united Muslims and showed fairness to everyone.",
            mcq: [{q:"Born?", options:["Cairo", "Tikrit", "Baghdad"], a:1},{q:"1187 victory?", options:["Jalut", "Hattin", "Plevna"], a:1},{q:"City?", options:["Rome", "Jerusalem", "Paris"], a:1},{q:"Trait?", options:["Cruelty", "Fairness/Respect", "Gold"], a:1},{q:"Goal?", options:["Conquer Rome", "Unite Muslims", "Walls"], a:1}]
        },
        {
            title: "Tariq ibn Ziyad", f: "tariq ibn ziyad",
            text: "Tariq ibn Ziyad was a famous Muslim commander in the 700s. At that time, the Visigoth kingdom ruled Spain. The people of North Africa wanted to go across the Mediterranean Sea. The Visigoth king, Roderick, was a harsh ruler. There were many problems inside his kingdom, and some rich nobles were not happy with him. This situation was good for Tariq ibn Ziyad. He was a governor in North Africa. In 711 AD, he led an army of about 7,000 soldiers across the water between Africa and Europe. He landed at a large rock. Later, people named it 'Jabal Tariq,' or the Mountain of Tariq. Today, we know it as Gibraltar. When his soldiers arrived, Tariq ordered them to burn their boats. He told his army: 'The sea is behind you, and the enemy is before you.' This brave speech helped his soldiers feel strong. Tariq‚Äôs army fought King Roderick at the Battle of Guadalete. Although the Visigoth army was much larger, Tariq used better plans. The unhappy Visigoth nobles also helped him win. King Roderick died in this fight. After this victory, Tariq took important cities like Cordoba and Toledo. His success began Muslim rule in Spain for nearly 800 years. Today, the name Gibraltar still remembers him.",
            mcq: [{q:"Place name today?", options:["Madrid", "Gibraltar", "Alps"], a:1},{q:"Boat command?", options:["Build wall", "Burn them", "Sell"], a:1},{q:"Defeated King?", options:["Philip", "Roderick", "Nero"], a:1},{q:"Rule length?", options:["8", "800", "8,000 years"], a:1},{q:"Crossing year?", options:["711 AD", "1000", "1492"], a:0}]
        }
    ];

    let currentMode = 'listen'; let isSlowMode = false; let repoFiles = [];
    const player = document.getElementById('player'); const list = document.getElementById('list');

    function norm(str) { 
        if(!str) return "";
        return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase().replace(" and ", " & ").trim(); 
    }

    async function fetchFiles() {
        try {
            const res = await fetch("https://api.github.com/repos/dogierez01/historic-people/contents/");
            const data = await res.json();
            if(Array.isArray(data)) {
                repoFiles = data.map(f => f.name);
                renderList();
            }
        } catch (e) { console.error("Fetch failed"); renderList(); }
    }
    fetchFiles();

    function startApp() { document.getElementById('splash-screen').style.display = 'none'; }

    function renderList() {
        const sorted = [...db].sort((a, b) => a.title.localeCompare(b.title));
        list.innerHTML = sorted.map((item) => {
            const originalIndex = db.findIndex(x => x.title === item.title);
            if (currentMode === 'listen') {
                return `<div class="card" data-name="${item.title.toLowerCase()}">
                    <div class="card-title">${item.title}</div>
                    <button class="listen-btn btn-uk" onclick="playHP(${originalIndex},'uk')">üá¨üáß 1. UK English</button>
                    <button class="listen-btn btn-us-f" onclick="playHP(${originalIndex},'female')">üá∫üá∏ 2. US Female</button>
                    <button class="listen-btn btn-us-m" onclick="openRead(${originalIndex})">üìñ 3. Read & Listen (US Male)</button>
                </div>`;
            } else {
                return `<button class="quiz-menu-btn" data-name="${item.title.toLowerCase()}" onclick="openQuiz(${originalIndex})">üß† ${item.title} Quiz</button>`;
            }
        }).join('');
    }

    function playHP(idx, type) {
        const item = db[idx];
        const BASE = "https://raw.githubusercontent.com/dogierez01/historic-people/main/";
        let key = norm(item.f); 
        let file = repoFiles.find(f => {
            const nf = norm(f);
            if (type === 'uk') return nf.includes(key) && nf.includes('uk');
            if (type === 'female') return nf.includes(key) && nf.includes('us') && nf.includes('female');
            if (type === 'male') return nf.includes(key) && nf.includes('us') && nf.includes('male') && !nf.includes('female');
            return false;
        });
        if (file) { player.src = BASE + encodeURIComponent(file); player.playbackRate = isSlowMode ? 0.8 : 1.0; player.play(); }
    }

    function openRead(i) {
        document.getElementById('story-text').innerText = db[i].text;
        document.getElementById('view-listen').style.display = 'block';
        document.getElementById('view-quiz').style.display = 'none';
        document.getElementById('modal').style.display = 'block';
        playHP(i, 'male');
    }

    function openQuiz(i) {
        document.getElementById('quiz-title').innerText = db[i].title + " MCQ Quiz";
        document.getElementById('quiz-area').innerHTML = db[i].mcq.map((q, qIdx) => `
            <div class="quiz-q"><div class="q-text">Q${qIdx+1}: ${q.q}</div>
            ${q.options.map((opt, oIdx) => `<button class="mcq-option" onclick="checkMCQ(this, ${q.a}, ${oIdx})">${opt}</button>`).join('')}
            <div class="feedback"></div></div>`).join('');
            document.getElementById('view-listen').style.display = 'none';
            document.getElementById('view-quiz').style.display = 'block';
            document.getElementById('modal').style.display = 'block';
    }

    function checkMCQ(btn, correctIdx, userIdx) {
        const parent = btn.parentElement;
        const fb = parent.querySelector('.feedback');
        if (correctIdx === userIdx) {
            fb.innerHTML = "<span class='correct'>‚úì CORRECT!</span>";
            btn.style.backgroundColor = "#2f9e44";
        } else {
            fb.innerHTML = "<span class='wrong'>‚úó WRONG!</span>";
            btn.style.backgroundColor = "#d63031";
        }
        parent.querySelectorAll('.mcq-option').forEach(b => b.disabled = true);
    }

    function setMode(m) { 
        currentMode = m; 
        document.getElementById('btn-listen').className = (m==='listen')?'toggle-btn active':'toggle-btn';
        document.getElementById('btn-quiz').className = (m==='quiz')?'toggle-btn active':'toggle-btn';
        renderList(); 
    }
    function closeModal() { document.getElementById('modal').style.display = 'none'; player.pause(); }
    function toggleSnail() { isSlowMode = !isSlowMode; player.playbackRate = isSlowMode ? 0.8 : 1.0; document.getElementById('btn-snail').classList.toggle('active'); }
    function filterList() {
        const val = document.getElementById('search').value.toLowerCase();
        document.querySelectorAll('.card, .quiz-menu-btn').forEach(el => {
            el.style.display = el.getAttribute('data-name').includes(val) ? 'block' : 'none';
        });
    }
</script>
</body>
</html>
