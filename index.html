<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Historic People - Master Edition</title>
    <style>
        body { font-family: -apple-system, sans-serif; background: #121212; color: #e0e0e0; margin: 0; padding: 0; overflow-x: hidden; }
        
        /* SPLASH SCREEN - NEON RED RING */
        #splash-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #121212; z-index: 10001; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; transition: opacity 0.5s ease; }
        .neon-ring { width: 350px; height: 350px; border-radius: 50%; border: 10px solid #ff0000; box-shadow: 0 0 40px #ff0000; display: flex; align-items: center; justify-content: center; animation: pulse 2s infinite; margin-bottom: 40px; overflow: hidden; background: #1a1a1a; }
        .logo-img { width: 100%; height: 100%; object-fit: cover; }
        @keyframes pulse { 0% { box-shadow: 0 0 20px #ff0000; } 50% { box-shadow: 0 0 60px #ff0000; } 100% { box-shadow: 0 0 20px #ff0000; } }
        #start-btn { padding: 20px 80px; font-size: 26px; font-weight: 900; color: white; background: linear-gradient(135deg, #d63031, #ff0000); border: none; border-radius: 60px; cursor: pointer; text-transform: uppercase; }

        /* HEADER AREA */
        #header-area { position: fixed; top: 0; width: 100%; background: #000; border-bottom: 2px solid #333; z-index: 100; padding: 15px 0; text-align: center; }
        #app-title { font-size: 22px; font-weight: 900; color: #fff; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 2px; }
        .toggle-container { display: flex; justify-content: center; margin-bottom: 5px; }
        .toggle-btn { padding: 12px 35px; border-radius: 30px; border: none; font-weight: bold; cursor: pointer; color: #888; background: #222; margin: 0 10px; transition: all 0.2s; font-size: 16px; }
        .toggle-btn.active { color: #fff; background: #007AFF; }
        
        #audio-bar { display: flex; justify-content: center; align-items: center; gap: 15px; margin-top: 15px; }
        #player { height: 45px; width: 75%; outline: none; }
        #btn-snail { background: #111; color: white; border: 2px solid #ff0033; font-size: 28px; padding: 5px 20px; border-radius: 12px; cursor: pointer; }
        #btn-snail.active { border-color: #39ff14; box-shadow: 0 0 10px #39ff14; }

        /* CONTENT ZONES */
        #content-area { padding: 20px; padding-top: 220px; max-width: 700px; margin: 0 auto; }
        .search-bar { width: 100%; padding: 15px; font-size: 18px; border-radius: 12px; border: 1px solid #333; background: #1e1e1e; color: white; margin-bottom: 20px; box-sizing: border-box; }
        .card { background: #1e1e1e; padding: 25px; margin-bottom: 20px; border-radius: 15px; border: 1px solid #333; }
        .card-title { font-size: 26px; font-weight: 900; color: #fff; margin-bottom: 20px; text-transform: capitalize; text-align: center; border-bottom: 1px solid #444; padding-bottom: 12px; }
        .listen-btn { padding: 18px; border-radius: 12px; border: none; cursor: pointer; font-weight: 900; font-size: 18px; color: white; display: block; width: 100%; margin-bottom: 12px; text-align: center; }
        .btn-uk { background: #d63031; } .btn-us-f { background: #e056fd; } .btn-us-m { background: #007AFF; }

        /* TEXT OVERLAY - 32PX FONT */
        #modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 3000; overflow-y: auto; }
        #modal-content { padding: 50px; max-width: 900px; margin: 0 auto; padding-top: 100px; }
        #close-btn { position: fixed; top: 30px; right: 30px; font-size: 35px; cursor: pointer; color: white; z-index: 3100; background: #ff0033; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: none; }
        #story-text { font-size: 32px; line-height: 1.6; color: #f0f0f0; text-align: justify; font-weight: 500; }

        /* MCQ ENLARGED */
        .quiz-q { background: #121212; padding: 30px; border-radius: 15px; margin-bottom: 30px; border-left: 10px solid #e056fd; }
        .q-text { font-size: 26px; font-weight: bold; color: #fff; margin-bottom: 25px; line-height: 1.3; }
        .mcq-option { width: 100%; padding: 20px; background: #1e1e1e; border: 2px solid #333; color: #fff; border-radius: 12px; font-size: 22px; font-weight: bold; text-align: left; margin-bottom: 15px; cursor: pointer; transition: 0.2s; }
        .feedback { font-weight: bold; display: block; margin-top: 20px; font-size: 28px; text-align: center; }
        .correct { color: #39ff14; } .wrong { color: #ff0033; }
        .quiz-menu-btn { width: 100%; padding: 20px; background: #1e1e1e; border: 1px solid #333; color: white; font-weight: bold; border-radius: 12px; margin-bottom: 15px; cursor: pointer; text-align: left; font-size: 22px; text-transform: capitalize; }
    </style>
</head>
<body>

<div id="splash-screen">
    <div class="neon-ring"><img src="logo.png" class="logo-img" onerror="this.src='https://raw.githubusercontent.com/dogierez01/historic-people/main/logo.png'"></div>
    <button onclick="startApp()" id="start-btn">START üèõÔ∏è</button>
</div>

<div id="header-area">
    <div id="app-title">üèõÔ∏è HISTORIC PEOPLE</div>
    <div class="toggle-container">
        <button id="btn-listen" class="toggle-btn active" onclick="setMode('listen')">üéß Listen</button>
        <button id="btn-quiz" class="toggle-btn" onclick="setMode('quiz')">üß† Quiz</button>
    </div>
    <div id="audio-bar">
        <audio id="player" controls controlsList="nodownload"></audio>
        <button id="btn-snail" onclick="toggleSnail()">üêå</button>
    </div>
</div>

<div id="content-area">
    <input type="text" id="search" class="search-bar" placeholder="Search a history figure..." onkeyup="filterList()">
    <div id="list"></div>
</div>

<div id="modal">
    <button id="close-btn" onclick="closeModal()">‚úï</button>
    <div id="modal-content">
        <div id="view-listen"><div id="story-text"></div></div>
        <div id="view-quiz" style="display:none;">
            <h2 id="quiz-title" style="text-align:center; font-size: 36px; margin-bottom: 30px;"></h2>
            <div id="quiz-area"></div>
        </div>
    </div>
</div>

<script>
    const db = [
        {
            title: "Alexander the Great",
            text: "Alexander was born in 356 BC in Pella, the capital of Macedon. His mother, Olympia, was a strong and mysterious woman. She prayed to snakes and kept many of them in the palace. Alexander grew up with these snakes. Poisonous snakes bit him, so his body became strong against poison. His father, King Philip II, was a very strict ruler. One night, he punished Alexander very badly. This difficult event helped make Alexander a fearless and strong man. Even as a young man, Alexander was special. He did not have a beard. He ordered all his soldiers to shave their faces, too. This rule for soldiers is still used today. He was a student of the famous teacher Aristotle. He learned about war and how to lead an army. He became a commander when he was still a teenager. Alexander wanted to conquer the whole world. He took control of many huge lands like Persia and Egypt. He even traveled as far as India. His army grew bigger and stronger. However, great power brought danger. When he was at the River Indus, his own generals turned against him. They poisoned him because they were tired of fighting. They wanted to stop and return to their homes and families.",
            mcq: [
                { q: "Why was Alexander's body resistant to poison?", options: ["Intense mountain training", "Exposure to palace snakes", "Ancient medicine"], a: 1 },
                { q: "What military rule did he establish?", options: ["Uniforms", "Shaving faces", "Diet laws"], a: 1 },
                { q: "Who was his famous teacher?", options: ["Plato", "Aristotle", "Socrates"], a: 2 },
                { q: "Where did his generals poison him?", options: ["River Indus", "River Nile", "Pella"], a: 0 },
                { q: "Why did the generals turn against him?", options: ["They wanted gold", "They were tired of fighting", "They were Persian spies"], a: 1 }
            ]
        },
        {
            title: "Baltacƒ± Mehmet Pasha",
            text: "Baltacƒ± Mehmet Pasha was an Ottoman grand vizier in the early 18th century. He is best known for his role in the Prut War between the Ottoman Empire and Russia in 1711. At that time, Russia was growing stronger under Tsar Peter the Great. The Ottomans, with the help of the Crimean Tatars, marched to stop them. Baltacƒ± Mehmet Pasha led the Ottoman army to the Prut River, where they surrounded the Russian forces. The Russians were trapped, hungry, and weak. It seemed that the Ottomans were ready for a great victory. Although the army had the chance to destroy the Russians, Baltacƒ± Mehmet Pasha accepted peace. With the Treaty of Prut, Russia gave back the city of Azov and promised to stay away from Ottoman lands. Peter the Great and his army were allowed to leave safely. Some people praised Baltacƒ± Mehmet Pasha for avoiding more bloodshed. Others blamed him for not using the chance to defeat Russia completely. After this, his career lost strength, but the Treaty of Prut remained an important event in Ottoman history.",
            mcq: [
                { q: "Who was the Tsar of Russia in 1711?", options: ["Ivan IV", "Peter the Great", "Nicholas I"], a: 1 },
                { q: "Which city did Russia return in the treaty?", options: ["Moscow", "Istanbul", "Azov"], a: 2 },
                { q: "Who assisted the Ottomans in the war?", options: ["Crimean Tatars", "British", "French"], a: 0 },
                { q: "Where were the Russian forces surrounded?", options: ["River Danube", "River Prut", "City of Azov"], a: 1 },
                { q: "What was the result for the Pasha's career?", options: ["He became Sultan", "It lost strength", "He retired in glory"], a: 1 }
            ]
        },
        {
            title: "Baybars",
            text: "Baybars was born in Central Asia around 1223. Sold as a slave, he became a Mamluk in Egypt. He defeated the Mongols at Ain Jalut in 1260 by using a pretend retreat to lure them into a valley. As Sultan, he built bridges, roads, and a fast horse mail system. He is remembered as a great protector of his people.",
            mcq: [
                { q: "What were Mamluks?", options: ["Egyptian nobles", "Soldier-slaves", "Merchant sailors"], a: 1 },
                { q: "Where did he defeat the Mongols?", options: ["Ain Jalut", "Cairo", "Plevna"], a: 0 },
                { q: "What was his winning tactic?", options: ["Siege", "Pretend retreat", "Night attack"], a: 1 },
                { q: "Which system did he improve as Sultan?", options: ["Public schools", "Horse mail system", "Navy ships"], a: 1 },
                { q: "Where was he originally born?", options: ["Egypt", "Central Asia", "Syria"], a: 1 }
            ]
        },
        {
            title: "Boudica",
            text: "Boudica was a warrior queen who led Celtic tribes against Roman rule in Britain. Enraged by Roman mistreatment of her family, she destroyed cities like Londinium. Though her army was larger, she was defeated in 61 AD by the governor Suetonius. Her death remains unknown; possibly suicide or illness.",
            mcq: [
                { q: "Which empire did Boudica fight?", options: ["Vikings", "Romans", "Greeks"], a: 1 },
                { q: "What triggered her rebellion?", options: ["Taxes", "Mistreatment of family", "Religion"], a: 1 },
                { q: "Which city did her forces destroy?", options: ["Londinium", "Rome", "Paris"], a: 0 },
                { q: "Who was the governor that stopped her?", options: ["Caesar", "Suetonius", "Nero"], a: 1 },
                { q: "How did she likely die?", options: ["Killed in battle", "Suicide or illness", "Old age"], a: 1 }
            ]
        },
        {
            title: "Cezzar Ahmed Pasha",
            text: "Governor of Acre, Cezzar Ahmed Pasha became a hero in 1799 by stopping Napoleon's invasion of Syria. Supported by British ships, he resisted a two-month siege. Napoleon's failure damaged his reputation and stopped his dream of entering Anatolia.",
            mcq: [
                { q: "Who attacked Acre in 1799?", options: ["Peter the Great", "Napoleon Bonaparte", "Julius Caesar"], a: 1 },
                { q: "Who supported the Ottomans with ships?", options: ["British", "Russians", "French"], a: 0 },
                { q: "How long did the siege last?", options: ["One month", "Two months", "Two years"], a: 1 },
                { q: "Why did the attacker want Acre?", options: ["Gold", "To enter Anatolia", "To build a palace"], a: 1 },
                { q: "What was the result for the attacker?", options: ["He became Sultan", "His reputation was damaged", "He won Syria"], a: 1 }
            ]
        },
        {
            title: "El Cid",
            text: "Rodrigo Diaz de Vivar ('El Cid') was a Spanish warrior known for his skill and respect for Muslim culture. Though exiled, he took Valencia in 1094 and allowed Muslim families to stay. He defended the city until his death in 1099, showing the power of cross-cultural alliances.",
            mcq: [
                { q: "What does 'El Cid' mean in Arabic?", options: ["The King", "The Respected", "The Sword"], a: 1 },
                { q: "Which city did he take in 1094?", options: ["Madrid", "Valencia", "Granada"], a: 1 },
                { q: "How did he treat Muslims in Valencia?", options: ["Exiled them", "Allowed them to stay", "Enslaved them"], a: 1 },
                { q: "Why was he exiled initially?", options: ["Accused of treachery", "Lost a battle", "Old age"], a: 0 },
                { q: "Who did he often work with in exile?", options: ["Monks", "Muslim rulers", "French kings"], a: 1 }
            ]
        },
        {
            title: "Fahrettin Pasha",
            text: "The 'Desert Tiger' defended Medina in WWI against the British-supported Arab revolt. Despite food scarcity that forced soldiers to eat locusts, he refused to surrender. He sent holy relics to Istanbul and was only removed by his own officers after the war ended.",
            mcq: [
                { q: "What was his nickname?", options: ["Iron Lion", "Desert Tiger", "Medina Tiger"], a: 1 },
                { q: "What did soldiers eat to survive?", options: ["Camel meat", "Locusts", "Desert fruit"], a: 1 },
                { q: "Who cut off Medina?", options: ["General Smith", "Lawrence of Arabia", "Tsar Peter"], a: 1 },
                { q: "What did he send to Istanbul?", options: ["Ottoman gold", "Holy relics", "His secret plans"], a: 1 },
                { q: "What happened after the war?", options: ["He died", "Ambassador to Afghanistan", "Became President"], a: 1 }
            ]
        },
        {
            title: "Gavrilo Princip",
            text: "Gavrilo Princip was a Serbian student whose assassination of Archduke Franz Ferdinand in 1914 started WWI. He died of illness in prison in 1918. He is remembered by some as a patriot and others as a terrorist.",
            mcq: [
                { q: "Where was he from?", options: ["Serbia", "Austria", "Bosnia"], a: 0 },
                { q: "Which war did his actions start?", options: ["Crimean", "World War I", "WWII"], a: 1 },
                { q: "Why did the Archduke's car stop?", options: ["Breakdown", "Wrong turn", "Traffic"], a: 1 },
                { q: "Why no death penalty?", options: ["Innocent", "Under 20 years old", "He escaped"], a: 1 },
                { q: "Where did he die?", options: ["Battlefield", "In prison", "At home"], a: 1 }
            ]
        },
        {
            title: "Gazi Osman Pasha",
            text: "A hero of the Russo-Turkish War, Gazi Osman Pasha defended Plevna for five months with strong trenches and clever tactics. Captured after a final attack in December 1877, he was respected by the Russians and returned to Istanbul as 'Gazi.'",
            mcq: [
                { q: "Which war made him famous?", options: ["WWI", "Russo-Turkish War", "Balkan War"], a: 1 },
                { q: "Which town did he defend?", options: ["Plevna", "Sofia", "Varna"], a: 0 },
                { q: "How long was the defense?", options: ["One month", "Five months", "One year"], a: 1 },
                { q: "How did Russians treat him?", options: ["Cruelly", "With dignity/respect", "They ignored him"], a: 1 },
                { q: "What title was he given?", options: ["Sultan", "Gazi", "Grand Vizier"], a: 1 }
            ]
        },
        {
            title: "Halil Pasha",
            text: "Commander at the Siege of Kut al-Amara in WWI, Halil Pasha forced the surrender of 13,000 British soldiers in 1916. After 147 days of hunger and disease, General Townshend surrendered, marking a huge Ottoman victory.",
            mcq: [
                { q: "Where is Kut al-Amara?", options: ["Turkey", "Iraq", "Egypt"], a: 1 },
                { q: "How many British surrendered?", options: ["1,300", "13,000", "130,000"], a: 1 },
                { q: "Who was the British general?", options: ["Smith", "Townshend", "Lawrence"], a: 1 },
                { q: "How long did the siege last?", options: ["47 days", "147 days", "300 days"], a: 1 },
                { q: "What was the result?", options: ["British won", "Ottoman victory", "Peace treaty"], a: 1 }
            ]
        },
        {
            title: "isabelle & ferdinand",
            text: "Catholic Monarchs of Spain, they united the country and finished the Reconquista in 1492. They expelled Muslims and Jews and supported Columbus's voyage, creating Spain's empire but leaving a legacy of religious removal.",
            mcq: [
                { q: "When was Granada captured?", options: ["1453", "1492", "1711"], a: 1 },
                { q: "Who was supported for a voyage?", options: ["Marco Polo", "Columbus", "Vasco da Gama"], a: 1 },
                { q: "What was the goal of Reconquista?", options: ["Take back Iberia", "Invade Italy", "Spread gold"], a: 0 },
                { q: "Result for non-Christians?", options: ["Given land", "Convert or leave", "Offices"], a: 1 },
                { q: "Status of kingdoms?", options: ["Divided", "United", "Enemies"], a: 1 }
            ]
        },
        {
            title: "Jacobi",
            text: "A Jewish physician (Yakup) sent by Venice to the Ottoman court. Mehmed II trusted him as head physician. He fell under suspicion when the Sultan died in 1481 after receiving medicine from him. His life ended in mystery.",
            mcq: [
                { q: "Under what name did he serve?", options: ["Jacobi", "Yakup", "Mustafa"], a: 1 },
                { q: "What was his role?", options: ["Architect", "Head Physician", "Soldier"], a: 1 },
                { q: "Which Sultan died under care?", options: ["Murad II", "Mehmed II", "Suleiman"], a: 1 },
                { q: "Who were his secret supporters?", options: ["British", "Venice/Vatican", "French"], a: 1 },
                { q: "Where was he born?", options: ["Near Genoa", "Istanbul", "Cairo"], a: 0 }
            ]
        },
        {
            title: "Koca Sinan Pasha",
            text: "Led the 'Bridge Disaster' at Giurgiu in 1595. Heavy treasure carts slowed the Danube crossing. Michael the Brave destroyed the wooden bridge, trapping and killing thousands of Akƒ±ncƒ± warriors, who never recovered.",
            mcq: [
                { q: "Which unit was destroyed?", options: ["Janissaries", "Akƒ±ncƒ±", "Mamluks"], a: 1 },
                { q: "What delayed the bridge?", options: ["Rain", "Treasure carts", "Snow"], a: 1 },
                { q: "Who destroyed the bridge?", options: ["Prince Eugene", "Michael the Brave", "Tsar Peter"], a: 1 },
                { q: "Where was the bridge?", options: ["Istanbul", "Giurgiu", "Plevna"], a: 1 },
                { q: "Unit result?", options: ["Stronger", "Never recovered", "Exiled"], a: 1 }
            ]
        },
        {
            title: "Mezamorta H√ºseyin Pasha",
            text: "An Ottoman admiral whose name means 'half-dead.' He modernized the navy with sailing kalyons and stopped a French attack on Algiers by firing a consul from a cannon. He died of illness in 1701.",
            mcq: [
                { q: "Nickname meaning?", options: ["Sea Lion", "Half-dead", "Great Captain"], a: 1 },
                { q: "How did he stop the French?", options: ["Burned fleet", "Fired consul from cannon", "Switching sides"], a: 1 },
                { q: "Modern ship introduced?", options: ["Rowing boat", "Kalyon", "Canoe"], a: 1 },
                { q: "Winner against whom?", options: ["French", "Venetians", "Russians"], a: 1 },
                { q: "Start of career?", options: ["Palace", "Sailor/Pirate", "Farmer"], a: 1 }
            ]
        },
        {
            title: "Mir Ali Beg",
            text: "Fought Portuguese in East Africa in the 1500s. In 1589 at Mombasa, Ottoman forces were attacked by Portuguese and cannibal Zimba warriors. Mir Ali Beg was captured and died a prisoner in Portugal.",
            mcq: [
                { q: "Region fought in?", options: ["North Africa", "East Africa", "India"], a: 1 },
                { q: "Land attacker?", options: ["Mongols", "Zimba tribe", "British"], a: 1 },
                { q: "Zimba trait?", options: ["Sailors", "Cannibals", "Spies"], a: 1 },
                { q: "Beg's fate?", options: ["Executed", "Prisoner in Portugal", "Escaped"], a: 1 },
                { q: "Ottoman result?", options: ["Expansion", "Ended influence in region", "Peace"], a: 1 }
            ]
        },
        {
            title: "Mustafa 'the second'",
            text: "Led the Tisa River disaster in 1695. Spies told Prince Eugene of Savoy his location. Greedy Pashas delayed the army for money. The bridge broke, 30,000 died, and Mustafa II watched helplessly. Led to land loss.",
            mcq: [
                { q: "Enemy general?", options: ["Smith", "Prince Eugene of Savoy", "Townshend"], a: 1 },
                { q: "Delay cause?", options: ["Storm", "Pashas demanding money", "Snow"], a: 1 },
                { q: "Soldiers lost?", options: ["3,000", "30,000", "100,000"], a: 1 },
                { q: "Treaty?", options: ["Prut", "Karlowitz", "Acre"], a: 1 },
                { q: "Extra loss?", options: ["Official seal", "Crown", "Horse"], a: 0 }
            ]
        },
        {
            title: "Ragnar Lodbrok",
            text: "9th-century Viking leader who attacked Paris in 845 and was paid silver to leave. Captured by King Aella of Northumbria and executed in a snake pit. His sons later killed the King for revenge.",
            mcq: [
                { q: "What does 'Lodbrok' mean?", options: ["Hairy pants", "Fast ship", "Great King"], a: 0 },
                { q: "Which city paid him silver?", options: ["London", "Paris", "Rome"], a: 1 },
                { q: "How did he die?", options: ["Battle", "Snake pit", "Old age"], a: 1 },
                { q: "Who were his sons?", options: ["Alexander/Philip", "Ivar/Bjorn", "Rob/Roy"], a: 1 },
                { q: "Who killed him?", options: ["King Aella", "Napoleon", "Eugene"], a: 0 }
            ]
        },
        {
            title: "Rob Roy",
            text: "Scottish 'Robin Hood' from the Highlands (1671-1734). A cattle farmer who became an outlaw after a noble took his land. Stole from the rich and gave to the poor while hiding in the mountains.",
            mcq: [
                { q: "Original job?", options: ["Soldier", "Cattle farmer", "Sailor"], a: 1 },
                { q: "Nickname?", options: ["Scot", "Robin Hood", "King"], a: 1 },
                { q: "Why an outlaw?", options: ["Stole crown", "Noble took his land", "Hated work"], a: 1 },
                { q: "Hideout?", options: ["London", "Highlands", "Island"], a: 1 },
                { q: "Clan?", options: ["MacGregor", "Aella", "Baybars"], a: 0 }
            ]
        },
        {
            title: "Salahuddin Ayyubi",
            text: "Saladin (1137) united Muslim lands against Crusaders. Won at Hattin in 1187 and captured Jerusalem. Known for fairness, he allowed Christians and Jews to stay or leave safely. Died in 1193.",
            mcq: [
                { q: "Birthplace?", options: ["Cairo", "Tikrit", "Baghdad"], a: 1 },
                { q: "City captured?", options: ["Rome", "Jerusalem", "Constantinople"], a: 1 },
                { q: "1187 victory?", options: ["Jalut", "Hattin", "Plevna"], a: 1 },
                { q: "Treatment of people?", options: ["Executed", "Kindness/Respect", "Slaves"], a: 1 },
                { q: "Main goal?", options: ["Europe", "Unite Muslim lands", "Pyramids"], a: 1 }
            ]
        },
        {
            title: "Skanderbeg",
            text: "Albania's hero (Gjergj Kastrioti). Soldier for Ottomans who revolted in 1443. For 20 years, he protected Albania using knowledge of Ottoman tactics. Pope called him 'Athlete of Christ.'",
            mcq: [
                { q: "Real name?", options: ["Mehmet", "Gjergj Kastrioti", "Osman"], a: 1 },
                { q: "Flag symbol?", options: ["Lion", "Double-headed eagle", "Star"], a: 1 },
                { q: "Resistance years?", options: ["2", "20", "50"], a: 1 },
                { q: "Pope title?", options: ["Athlete of Christ", "Saint", "King"], a: 0 },
                { q: "Trained where?", options: ["Rome", "Ottoman Empire", "Paris"], a: 1 }
            ]
        },
        {
            title: "Spartacus",
            text: "Gladiator who led a 73 BC slave revolt against Rome. Escaped Capua with  kitchen knives and hid at Mount Vesuvius. Defeated by Crassus in 71 BC, leading to 6,000 crucifixions.",
            mcq: [
                { q: "Origin?", options: ["Rome", "Thrace", "Egypt"], a: 1 },
                { q: "Escape tool?", options: ["Sword", "Kitchen knives", "Chains"], a: 1 },
                { q: "Hideout?", options: ["Colosseum", "Vesuvius", "Palace"], a: 1 },
                { q: "Defeated by?", options: ["Caesar", "Crassus", "Napoleon"], a: 1 },
                { q: "Fate of 6,000?", options: ["Freed", "Crucified", "Exiled"], a: 1 }
            ]
        },
        {
            title: "Stefan Du≈°an",
            text: "Ruled Serbia (1331-1355) and aimed to take Constantinople before Ottomans. Tried to form united Christian army but died suddenly in 1355. Empire weakened and divided afterward.",
            mcq: [
                { q: "Main goal?", options: ["Rome", "Take Constantinople", "Sailing"], a: 1 },
                { q: "Threat?", options: ["British", "Ottoman Turks", "French"], a: 1 },
                { q: "Alliance with?", options: ["France", "Pope/Venice", "Russia"], a: 1 },
                { q: "Post-death empire?", options: ["Stronger", "Weakened/Divided", "Stable"], a: 1 },
                { q: "Battle 34y later?", options: ["Jalut", "Maritsa", "Plevna"], a: 1 }
            ]
        },
        {
            title: "Taras Bulba",
            text: "Cossack warrior in 1500s Ukraine fighting Polish rule. Killed son Andriy for betraying them for a Polish woman. Son Ostap killed in Warsaw. Remembered as hero of traditions.",
            mcq: [
                { q: "Fought who?", options: ["Russia", "Poland", "Germany"], a: 1 },
                { q: "Killed Andriy why?", options: ["Cowardice", "Betrayal/Love for enemy", "Stealing"], a: 1 },
                { q: "Ostap killed where?", options: ["Kyiv", "Warsaw", "London"], a: 1 },
                { q: "Famous line?", options: ["Go", "Gave life, take it", "I hate you"], a: 1 },
                { q: "Group?", options: ["Vikings", "Cossacks", "Mamluks"], a: 1 }
            ]
        },
        {
            title: "Tariq ibn Ziyad",
            text: "Led 7,000 soldiers into Spain in 711 AD. Burned boats to show no retreat at Gibraltar (Jabal Tariq). Defeated King Roderick at Guadalete, starting 800 years of Muslim rule.",
            mcq: [
                { q: "Landmark name?", options: ["Madrid", "Gibraltar", "Paris"], a: 1 },
                { q: "Boat order?", options: ["Sell", "Burn", "Sink"], a: 1 },
                { q: "King defeated?", options: ["Philip", "Roderick", "Nero"], a: 1 },
                { q: "Soldier count?", options: ["700", "7,000", "70,000"], a: 1 },
                { q: "Years of rule?", options: ["8", "800", "8,000"], a: 1 }
            ]
        },
        {
            title: "Timur (Tamerlane)",
            text: "Central Asian conqueror (1336) who captured Sultan Bayezid at Ankara in 1402 by turning his soldiers. Died in 1405 planning to invade China. Known for strength and cruelty.",
            mcq: [
                { q: "Sultan captured?", options: ["Mustafa", "Bayezid", "Mehmed"], a: 1 },
                { q: "Ankara win how?", options: ["Cannons", "Switching soldiers", "Night"], a: 1 },
                { q: "Died invading?", options: ["India", "Egypt", "China"], a: 2 },
                { q: "Route controlled?", options: ["Silk Road", "Spice", "Ocean"], a: 0 },
                { q: "Bayezid fate?", options: ["Freed", "Died prisoner", "Escaped"], a: 1 }
            ]
        },
        {
            title: "Tomyris",
            text: "Queen Tomyris of Massagetae defeated Cyrus the Great (Persia) in 530 BC. Cyrus trapped her son with wine; he died. She avenged him by cutting off Cyrus's head and putting it in a bag of blood.",
            mcq: [
                { q: "King defeated?", options: ["Xerxes", "Cyrus the Great", "Darius"], a: 1 },
                { q: "Trick used?", options: ["Peace", "Wine/Food", "Spies"], a: 1 },
                { q: "Head fate?", options: ["Rome", "Bag of blood", "Buried"], a: 1 },
                { q: "Son's death?", options: ["Battle", "Suicide", "Old age"], a: 1 },
                { q: "Location?", options: ["Egypt", "Central Asia", "France"], a: 1 }
            ]
        },
        {
            title: "Turgut Reis",
            text: "Sailor who became an Ottoman admiral. Prisoner of Genoese for 3 years. Moved ships overland at Djerba. Governor of Tripoli, died at Siege of Malta 1565.",
            mcq: [
                { q: "Rescuer?", options: ["Suleiman", "Barbarossa", "Yusuf"], a: 1 },
                { q: "Djerba escape?", options: ["Swimming", "Overland ships", "Storm"], a: 1 },
                { q: "Death siege?", options: ["Vienna", "Malta", "Acre"], a: 1 },
                { q: "Tomb location?", options: ["Istanbul", "Tripoli", "Malta"], a: 1 },
                { q: "Prisoner time?", options: ["1 month", "3 years", "10 years"], a: 1 }
            ]
        },
        {
            title: "Vlad III (Dracula)",
            text: "Prince of Wallachia known as 'The Impaler.' Hostage in Ottoman palace who later used scorched earth against Mehmed II. Head sent to Mehmed as proof in 1476.",
            mcq: [
                { q: "Name meaning?", options: ["Impaler", "Son of Dragon", "King"], a: 1 },
                { q: "Hostage where?", options: ["Rome", "Ottoman Empire", "Paris"], a: 1 },
                { q: "Brother name?", options: ["Radu", "Mustafa", "Stefan"], a: 0 },
                { q: "Tactic?", options: ["Scorched earth", "Wall", "Bribe"], a: 0 },
                { q: "Head to whom?", options: ["Philip", "Mehmed II", "Pope"], a: 1 }
            ]
        },
        {
            title: "William Tell",
            text: "Swiss hero who shot an apple off his son's head. Admitted second arrow was for the ruler Gessler. Escaped storm, killed Gessler, and inspired rebellion for independence.",
            mcq: [
                { q: "Target?", options: ["Grape", "Apple", "Bird"], a: 1 },
                { q: "2nd arrow for?", options: ["Son", "Gessler", "King"], a: 1 },
                { q: "Escape?", options: ["Swim", "Steering/Storm", "Bribe"], a: 1 },
                { q: "On the pole?", options: ["Sword", "Hat", "Picture"], a: 1 },
                { q: "Nation?", options: ["Scotland", "Switzerland", "Albania"], a: 1 }
            ]
        },
        {
            title: "William Wallace",
            text: "Scottish hero who rebelled after English soldiers killed his wife. Won at Stirling Bridge (1297) but lost at Falkirk. Executed in London 1305.",
            mcq: [
                { q: "English King?", options: ["Henry", "Edward I", "Richard"], a: 1 },
                { q: "Victory?", options: ["Falkirk", "Stirling Bridge", "London"], a: 1 },
                { q: "Trigger?", options: ["Gold", "Wife killed", "Land"], a: 1 },
                { q: "Execution city?", options: ["Edinburgh", "London", "Paris"], a: 1 },
                { q: "Successor?", options: ["Bruce", "Tell", "Saladin"], a: 0 }
            ]
        },
        {
            title: "Yusuf Pasha",
            text: "Won without a fight in 1788 when the Austrian army of 100,000 destroyed itself due to confusion/alcohol. misheard 'Halt' as 'Allah' and fired on each other.",
            mcq: [
                { q: "Destruction cause?", options: ["Plague", "Alcohol/Confusion", "Storm"], a: 1 },
                { q: "Mistaken word?", options: ["Halt", "Attack", "Run"], a: 0 },
                { q: "Army size?", options: ["1,000", "100,000", "500,000"], a: 1 },
                { q: "Country?", options: ["Turkey", "Romania", "Germany"], a: 1 },
                { q: "Effort?", options: ["Siege", "Battle", "None"], a: 2 }
            ]
        }
    ];

    let currentMode = 'listen'; let isSlowMode = false; let repoFiles = [];
    const player = document.getElementById('player'); const list = document.getElementById('list');

    // HELPER: Normalize string for matching (removes accents/special marks)
    function norm(str) { return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase().replace(" and ", " & ").trim(); }

    async function fetchFiles() {
        try {
            const res = await fetch("https://api.github.com/repos/dogierez01/historic-people/contents/");
            const data = await res.json();
            repoFiles = data.map(f => f.name);
            renderList();
        } catch (e) { renderList(); }
    }
    fetchFiles();

    function startApp() { document.getElementById('splash-screen').style.display = 'none'; }

    function renderList() {
        const sorted = [...db].sort((a, b) => a.title.localeCompare(b.title));
        list.innerHTML = sorted.map((item) => {
            const originalIndex = db.findIndex(x => x.title === item.title);
            if (currentMode === 'listen') {
                return `<div class="card" data-name="${item.title.toLowerCase()}">
                    <div class="card-title">${item.title}</div>
                    <button class="listen-btn btn-uk" onclick="playHP(${originalIndex},'uk')">üá¨üáß 1. UK English</button>
                    <button class="listen-btn btn-us-f" onclick="playHP(${originalIndex},'female')">üá∫üá∏ 2. US Female</button>
                    <button class="listen-btn btn-us-m" onclick="openRead(${originalIndex})">üìñ 3. Read & Listen (US Male)</button>
                </div>`;
            } else {
                return `<button class="quiz-menu-btn" data-name="${item.title.toLowerCase()}" onclick="openQuiz(${originalIndex})">üß† ${item.title} Quiz</button>`;
            }
        }).join('');
    }

    function playHP(idx, type) {
        const item = db[idx];
        const BASE = "https://raw.githubusercontent.com/dogierez01/historic-people/main/";
        let key = norm(item.title);
        
        let file = "";
        if (type === 'uk') file = repoFiles.find(f => norm(f).includes(key) && norm(f).includes('uk'));
        else if (type === 'female') file = repoFiles.find(f => norm(f).includes(key) && norm(f).includes('us') && norm(f).includes('female'));
        else if (type === 'male') {
            file = repoFiles.find(f => norm(f).includes(key) && norm(f).includes('us') && norm(f).includes('male') && !norm(f).includes('female'));
        }
        if (file) { player.src = BASE + encodeURIComponent(file); player.playbackRate = isSlowMode ? 0.8 : 1.0; player.play(); }
    }

    function openRead(i) {
        document.getElementById('story-text').innerText = db[i].text;
        document.getElementById('view-listen').style.display = 'block';
        document.getElementById('view-quiz').style.display = 'none';
        document.getElementById('modal').style.display = 'block';
        playHP(i, 'male');
    }

    function openQuiz(i) {
        document.getElementById('quiz-title').innerText = db[i].title + " MCQ Quiz";
        document.getElementById('quiz-area').innerHTML = db[i].mcq.map((q, qIdx) => `
            <div class="quiz-q"><div class="q-text">Q${qIdx+1}: ${q.q}</div>
            ${q.options.map((opt, oIdx) => `<button class="mcq-option" onclick="checkMCQ(this, ${q.a}, ${oIdx})">${opt}</button>`).join('')}
            <div class="feedback"></div></div>`).join('');
        document.getElementById('view-listen').style.display = 'none';
        document.getElementById('view-quiz').style.display = 'block';
        document.getElementById('modal').style.display = 'block';
    }

    function checkMCQ(btn, correctIdx, userIdx) {
        const parent = btn.parentElement;
        const fb = parent.querySelector('.feedback');
        if (correctIdx === userIdx) {
            fb.innerHTML = "<span class='correct'>‚úì CORRECT!</span>";
            btn.style.backgroundColor = "#2f9e44";
        } else {
            fb.innerHTML = "<span class='wrong'>‚úó WRONG!</span>";
            btn.style.backgroundColor = "#d63031";
        }
        parent.querySelectorAll('.mcq-option').forEach(b => b.disabled = true);
    }

    function setMode(m) { 
        currentMode = m; 
        document.getElementById('btn-listen').className = (m==='listen')?'toggle-btn active':'toggle-btn';
        document.getElementById('btn-quiz').className = (m==='quiz')?'toggle-btn active':'toggle-btn';
        renderList(); 
    }
    function closeModal() { document.getElementById('modal').style.display = 'none'; player.pause(); }
    function toggleSnail() { isSlowMode = !isSlowMode; player.playbackRate = isSlowMode ? 0.8 : 1.0; document.getElementById('btn-snail').classList.toggle('active'); }
    function filterList() {
        const val = document.getElementById('search').value.toLowerCase();
        document.querySelectorAll('.card, .quiz-menu-btn').forEach(el => {
            el.style.display = el.getAttribute('data-name').includes(val) ? 'block' : 'none';
        });
    }
</script>
</body>
</html>
