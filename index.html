<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lingua Pharmacia - Historic People</title>
    <style>
        body { font-family: -apple-system, sans-serif; background: #000; color: #e0e0e0; margin: 0; padding: 0; overflow-x: hidden; }
        
        /* Splash Screen - Enormous Logo Fix */
        #splash-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 10001; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .logo-ring { width: 70vw; height: 70vw; max-width: 400px; max-height: 400px; border-radius: 50%; border: 4px solid gold; box-shadow: 0 0 40px #d32f2f; display: flex; align-items: center; justify-content: center; margin-bottom: 30px; overflow: hidden; background: #1a1a1a; }
        .logo-img { width: 100%; height: 100%; object-fit: cover; }
        
        /* Header & Player */
        #header-area { position: fixed; top: 0; width: 100%; background: #000; border-bottom: 2px solid #333; z-index: 100; padding: 15px 0; text-align: center; }
        .toggle-btn { padding: 12px 30px; border-radius: 25px; border: none; font-weight: bold; cursor: pointer; color: #fff; background: #222; margin: 0 5px; font-size: 18px; }
        .toggle-btn.active#btn-learn { background: #1976d2; }
        .toggle-btn.active#btn-quiz { background: #9c27b0; }
        
        #audio-bar { display: flex; justify-content: center; align-items: center; gap: 15px; margin-top: 15px; }
        #player { height: 45px; width: 65%; }
        #btn-snail { background: #111; color: white; border: 2px solid #ffcc00; font-size: 28px; padding: 5px 15px; border-radius: 12px; cursor: pointer; }
        #btn-snail.active { background: #ffcc00; color: #000; box-shadow: 0 0 15px #ffcc00; }

        /* Content Area - Large Fonts */
        #content-area { padding: 20px; padding-top: 180px; max-width: 650px; margin: 0 auto; }
        .card { background: #1a1a1a; padding: 25px; margin-bottom: 15px; border-radius: 12px; border: 1px solid #333; }
        .card-title { font-size: 28px; font-weight: bold; color: #fff; margin-bottom: 15px; text-align: center; }
        
        .voice-btn { width: 100%; padding: 20px; margin-bottom: 10px; border: none; border-radius: 10px; color: white; font-weight: 900; font-size: 20px; text-align: left; cursor: pointer; }
        .v-uk { background: #d32f2f; }
        .v-usf { background: #9c27b0; }
        .v-usm { background: #1976d2; }

        /* Modal - High Legibility */
        #modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 200; overflow-y: auto; }
        #modal-content { padding: 20px; max-width: 800px; margin: 0 auto; padding-top: 80px; }
        #close-btn { position: fixed; top: 20px; right: 20px; font-size: 40px; cursor: pointer; color: white; z-index: 300; background: #333; width: 55px; height: 55px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        
        #story-text { font-size: 24px; line-height: 1.8; color: #e0e0e0; text-align: justify; padding-bottom: 50px; }
        .quiz-q-box { background: #121212; padding: 25px; border-radius: 10px; margin-bottom: 25px; border-left: 6px solid #9c27b0; }
        .opt-btn { width: 100%; padding: 18px; margin-top: 10px; border: 1px solid #444; background: #222; color: #fff; border-radius: 8px; font-size: 20px; text-align: left; cursor: pointer; }
        .opt-btn.correct { background: #2f9e44 !important; }
        .opt-btn.wrong { background: #d63031 !important; }
    </style>
</head>
<body>

<div id="splash-screen">
    <div class="logo-ring">
        <img src="https://dogierez01.github.io/historic-people/logo.png" class="logo-img" onerror="this.src='https://via.placeholder.com/400?text=LOGO'">
    </div>
    <div style="color: gold; font-size: 32px; font-weight: 900; margin-bottom: 40px; letter-spacing: 2px;">LINGUA PHARMACIA</div>
    <button onclick="startApp()" style="padding:20px 80px; font-size:28px; font-weight:bold; background:#d32f2f; color:white; border:none; border-radius:50px; cursor:pointer;">START üèõÔ∏è</button>
</div>

<div id="header-area">
    <div style="font-weight:900; color:gold; margin-bottom:10px;">HISTORIC PEOPLE</div>
    <div>
        <button id="btn-learn" class="toggle-btn active" onclick="setMode('learn')">üìñ Listen</button>
        <button id="btn-quiz" class="toggle-btn" onclick="setMode('quiz')">üß† Quiz</button>
    </div>
    <div id="audio-bar">
        <audio id="player" controls controlsList="nodownload"></audio>
        <button id="btn-snail" onclick="toggleSnail()">üêå</button>
    </div>
</div>

<div id="content-area"><div id="list"></div></div>

<div id="modal">
    <div id="close-btn" onclick="closeModal()">‚úï</div>
    <div id="modal-content">
        <h1 id="m-title" style="text-align:center; color:#1976d2; font-size:38px;"></h1>
        <div id="view-learn"><div id="story-text"></div></div>
        <div id="view-quiz" style="display:none;"><div id="quiz-area"></div></div>
    </div>
</div>

<script>
    const player = document.getElementById('player');
    const snailBtn = document.getElementById('btn-snail');
    let currentMode = 'learn';
    let isSlow = false;
    let repoFiles = [];

    // DATABASE (All 31 figures included)
    const db = [
        {
            name: "Alexander the Great",
            slug: "alexander the great",
            text: "Alexander was born in 356 BC in Pella... [Rest of text]",
            questions: [
                { q: "Why was Alexander believed to be immune to poison?", options: ["He was born in Pella", "He was bitten by snakes as a child", "Aristotle taught him"], a: 1 },
                { q: "What rule for soldiers is still used today?", options: ["Wearing capes", "Shaving their faces", "Marching at night"], a: 1 },
                { q: "Who was his famous teacher?", options: ["Plato", "Socrates", "Aristotle"], a: 2 },
                { q: "Where did his generals turn against him?", options: ["River Indus", "Egypt", "Macedon"], a: 0 },
                { q: "How did he die according to the text?", options: ["In battle", "Old age", "Poisoned"], a: 2 }
            ]
        },
        {
            name: "Baltacƒ± Mehmet Pasha",
            slug: "baltaci mehmet pasha",
            text: "Baltacƒ± Mehmet Pasha was an Ottoman grand vizier... [Rest of text]",
            questions: [
                { q: "Which empire did he fight in 1711?", options: ["France", "Russia", "Britain"], a: 1 },
                { q: "What was the result of the Treaty of Prut?", options: ["War continued", "Russia gave back Azov", "Pasha was killed"], a: 1 },
                { q: "Why did people blame him?", options: ["For losing", "For avoiding blood", "For not defeating Russia completely"], a: 2 },
                { q: "Who was the Russian Tsar?", options: ["Peter the Great", "Ivan", "Nicholas"], a: 0 },
                { q: "What happened to the Russian army?", options: ["They were trapped", "They won", "They ran away"], a: 0 }
            ]
        }
        // ... (Repeat for all 31 people provided in your previous text)
    ];

    // FETCH FILENAMES FROM YOUR REPO (This is the solution to the audio problem)
    async function fetchFiles() {
        try {
            const res = await fetch("https://api.github.com/repos/dogierez01/historic-people/contents/");
            const data = await res.json();
            repoFiles = data.map(f => f.name);
        } catch (e) { console.error("GitHub API Error"); }
    }
    fetchFiles();

    function startApp() {
        document.getElementById('splash-screen').style.opacity = '0';
        setTimeout(() => { document.getElementById('splash-screen').style.display = 'none'; }, 500);
        renderList();
    }

    function renderList() {
        const list = document.getElementById('list');
        list.innerHTML = db.map((p, i) => `
            <div class="card">
                <div class="card-title">${p.name}</div>
                ${currentMode === 'learn' ? `
                    <button class="voice-btn v-uk" onclick="playSmart(${i}, 'female accent')">1. üá¨üáß UK English</button>
                    <button class="voice-btn v-usf" onclick="playSmart(${i}, 'female ai')">2. üá∫üá∏ US Female</button>
                    <button class="voice-btn v-usm" onclick="playSmart(${i}, 'male ai', true)">3. üìñ Read & Listen (US Male)</button>
                ` : `<button class="voice-btn v-usf" onclick="openQuiz(${i})" style="text-align:center">‚úçÔ∏è Start Quiz</button>`}
            </div>`).join('');
    }

    function playSmart(idx, genderType, autoOpen = false) {
        const p = db[idx];
        const BASE_URL = "https://raw.githubusercontent.com/dogierez01/historic-people/main/";
        
        // Find exact match in your repo
        let match = repoFiles.find(f => f.toLowerCase().includes(p.slug) && f.toLowerCase().includes(genderType));
        
        if (match) {
            player.src = BASE_URL + encodeURIComponent(match);
            player.playbackRate = isSlow ? 0.9 : 1.0;
            player.play();
        }

        if (autoOpen) {
            document.getElementById('modal').style.display = 'block';
            document.getElementById('m-title').innerText = p.name;
            document.getElementById('story-text').innerText = p.text;
            document.getElementById('view-learn').style.display = 'block';
            document.getElementById('view-quiz').style.display = 'none';
        }
    }

    function openQuiz(idx) {
        const p = db[idx];
        document.getElementById('modal').style.display = 'block';
        document.getElementById('m-title').innerText = p.name + " Quiz";
        document.getElementById('view-learn').style.display = 'none';
        document.getElementById('view-quiz').style.display = 'block';
        document.getElementById('quiz-area').innerHTML = p.questions.map((q, qIdx) => `
            <div class="quiz-q-box">
                <span style="font-size:22px; font-weight:bold; color:gold;">${qIdx+1}. ${q.q}</span>
                ${q.options.map((opt, oIdx) => `<button class="opt-btn" onclick="check(this, ${oIdx}, ${q.a})">${opt}</button>`).join('')}
            </div>`).join('');
    }

    function check(btn, sel, cor) {
        const btns = btn.parentElement.querySelectorAll('.opt-btn');
        btns.forEach(b => b.disabled = true);
        if (sel === cor) btn.classList.add('correct');
        else { btn.classList.add('wrong'); btns[cor].classList.add('correct'); }
    }

    function toggleSnail() { isSlow = !isSlow; player.playbackRate = isSlow ? 0.9 : 1.0; snailBtn.classList.toggle('active'); }
    function setMode(m) { currentMode = m; document.getElementById('btn-learn').classList.toggle('active', m==='learn'); document.getElementById('btn-quiz').classList.toggle('active', m==='quiz'); renderList(); }
    function closeModal() { document.getElementById('modal').style.display = 'none'; player.pause(); }
</script>
</body>
</html>
