<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Historic People - Master Edition</title>
    <style>
        body { font-family: -apple-system, sans-serif; background: #121212; color: #e0e0e0; margin: 0; padding: 0; overflow-x: hidden; }
        #splash-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #121212; z-index: 10001; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; transition: opacity 0.5s ease; }
        .neon-ring { width: 350px; height: 350px; border-radius: 50%; border: 10px solid #ff0000; box-shadow: 0 0 40px #ff0000; display: flex; align-items: center; justify-content: center; animation: pulse 2s infinite; margin-bottom: 40px; overflow: hidden; background: #1a1a1a; }
        .logo-img { width: 100%; height: 100%; object-fit: cover; }
        @keyframes pulse { 0% { box-shadow: 0 0 20px #ff0000; } 50% { box-shadow: 0 0 60px #ff0000; } 100% { box-shadow: 0 0 20px #ff0000; } }
        #start-btn { padding: 20px 80px; font-size: 26px; font-weight: 900; color: white; background: linear-gradient(135deg, #d63031, #ff0000); border: none; border-radius: 60px; cursor: pointer; text-transform: uppercase; }
        #header-area { position: fixed; top: 0; width: 100%; background: #000; border-bottom: 2px solid #333; z-index: 100; padding: 15px 0; text-align: center; }
        #app-title { font-size: 22px; font-weight: 900; color: #fff; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 2px; }
        .toggle-btn { padding: 12px 35px; border-radius: 30px; border: none; font-weight: bold; cursor: pointer; color: #888; background: #222; margin: 0 10px; transition: all 0.2s; font-size: 16px; }
        .toggle-btn.active { color: #fff; background: #007AFF; }
        #audio-bar { display: flex; justify-content: center; align-items: center; gap: 15px; margin-top: 15px; }
        #player { height: 45px; width: 75%; outline: none; }
        #btn-snail { background: #111; color: white; border: 2px solid #ff0033; font-size: 28px; padding: 5px 20px; border-radius: 12px; cursor: pointer; }
        #btn-snail.active { background: #0a1f0a; border-color: #39ff14; box-shadow: 0 0 10px #39ff14; }
        #content-area { padding: 20px; padding-top: 220px; max-width: 700px; margin: 0 auto; }
        .card { background: #1e1e1e; padding: 25px; margin-bottom: 20px; border-radius: 15px; border: 1px solid #333; }
        .card-title { font-size: 26px; font-weight: 900; color: #fff; margin-bottom: 20px; text-transform: capitalize; text-align: center; border-bottom: 1px solid #444; padding-bottom: 12px; }
        .listen-btn { padding: 18px; border-radius: 12px; border: none; cursor: pointer; font-weight: 900; font-size: 18px; color: white; display: block; width: 100%; margin-bottom: 12px; }
        .btn-uk { background: #d63031; } .btn-us-f { background: #e056fd; } .btn-us-m { background: #007AFF; }
        #modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 3000; overflow-y: auto; }
        #modal-content { padding: 50px; max-width: 900px; margin: 0 auto; padding-top: 100px; }
        #close-btn { position: fixed; top: 30px; right: 30px; font-size: 35px; cursor: pointer; color: white; z-index: 3100; background: #ff0033; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: none; }
        #story-text { font-size: 32px; line-height: 1.6; color: #f0f0f0; text-align: justify; font-weight: 500; }
        .quiz-q { background: #121212; padding: 30px; border-radius: 15px; margin-bottom: 30px; border-left: 10px solid #e056fd; }
        .q-text { font-size: 26px; font-weight: bold; color: #fff; margin-bottom: 25px; line-height: 1.3; }
        .mcq-option { width: 100%; padding: 20px; background: #1e1e1e; border: 2px solid #333; color: #fff; border-radius: 12px; font-size: 22px; font-weight: bold; text-align: left; margin-bottom: 15px; cursor: pointer; }
        .feedback { font-weight: bold; display: block; margin-top: 20px; font-size: 28px; text-align: center; }
        .correct { color: #39ff14; } .wrong { color: #ff0033; }
        .quiz-menu-btn { width: 100%; padding: 20px; background: #1e1e1e; border: 1px solid #333; color: white; font-weight: bold; border-radius: 12px; margin-bottom: 15px; cursor: pointer; text-align: left; font-size: 22px; text-transform: capitalize; }
    </style>
</head>
<body>
<div id="splash-screen"><div class="neon-ring"><img src="logo.png" class="logo-img" onerror="this.src='https://raw.githubusercontent.com/dogierez01/historic-people/main/logo.png'"></div><button onclick="startApp()" id="start-btn">START üèõÔ∏è</button></div>
<div id="header-area"><div id="app-title">üèõÔ∏è HISTORIC PEOPLE</div><div style="display:flex; justify-content:center;"><button id="btn-listen" class="toggle-btn active" onclick="setMode('listen')">üéß Listen</button><button id="btn-quiz" class="toggle-btn" onclick="setMode('quiz')">üß† Quiz</button></div><div id="audio-bar"><audio id="player" controls controlsList="nodownload"></audio><button id="btn-snail" onclick="toggleSnail()">üêå</button></div></div>
<div id="content-area"><input type="text" id="search" class="search-bar" placeholder="Search a history figure..." onkeyup="filterList()"><div id="list"></div></div>
<div id="modal"><button id="close-btn" onclick="closeModal()">‚úï</button><div id="modal-content"><div id="view-listen"><div id="story-text"></div></div><div id="view-quiz" style="display:none;"><h2 id="quiz-title" style="text-align:center; font-size:36px; margin-bottom:30px;"></h2><div id="quiz-area"></div></div></div></div>
<script>
    const db = [
        {
            title: "Alexander the Great", fileKey: "alexander the great",
            text: "Alexander was born in 356 BC in Pella, the capital of Macedon. His mother, Olympia, was a strong and mysterious woman. She prayed to snakes and kept many of them in the palace. Alexander grew up with these snakes. Poisonous snakes bit him, so his body became strong against poison. His father, King Philip II, was a very strict ruler. One night, he punished Alexander very badly. This difficult event helped make Alexander a fearless and strong man. Even as a young man, Alexander was special. He did not have a beard. He ordered all his soldiers to shave their faces, too. This rule for soldiers is still used today. He was a student of the famous teacher Aristotle. He learned about war and how to lead an army. He became a commander when he was still a teenager. Alexander wanted to conquer the whole world. He took control of many huge lands like Persia and Egypt. He even traveled as far as India. His army grew bigger and stronger. However, great power brought danger. When he was at the River Indus, his own generals turned against him. They poisoned him because they were tired of fighting. They wanted to stop and return to their homes and families.",
            mcq: [{q:"Why was Alexander's body resistant to poison?", options:["Intense exercise", "Palace snakes", "Herbal tea"], a:1},{q:"Which tradition for soldiers started with him?", options:["Uniforms", "Shaving", "Marching"], a:1},{q:"Who was his tutor?", options:["Aristotle", "Plato", "Socrates"], a:0},{q:"Where did generals conspire?", options:["Indus River", "Nile", "Greece"], a:0},{q:"Why did they poison him?", options:["Gold", "Fatigue", "Bribe"], a:1}]
        },
        {
            title: "Baltacƒ± Mehmet Pasha", fileKey: "baltaci mehmet",
            text: "Baltacƒ± Mehmet Pasha was an Ottoman grand vizier in the early 18th century. He is best known for his role in the Prut War between the Ottoman Empire and Russia in 1711. At that time, Russia was growing stronger under Tsar Peter the Great. The Ottomans, with the help of the Crimean Tatars, marched to stop them. Baltacƒ± Mehmet Pasha led the Ottoman army to the Prut River, where they surrounded the Russian forces. The Russians were trapped, hungry, and weak. It seemed that the Ottomans were ready for a great victory. Although the army had the chance to destroy the Russians, Baltacƒ± Mehmet Pasha accepted peace. With the Treaty of Prut, Russia gave back the city of Azov and promised to stay away from Ottoman lands. Peter the Great and his army were allowed to leave safely. Some people praised Baltacƒ± Mehmet Pasha for avoiding more bloodshed. Others blamed him for not using the chance to defeat Russia completely. After this, his career lost strength, but the Treaty of Prut remained an important event in Ottoman history.",
            mcq: [{q:"Tsar of Russia in 1711?", options:["Nicholas", "Peter the Great", "Ivan"], a:1},{q:"Return city in treaty?", options:["Moscow", "Istanbul", "Azov"], a:2},{q:"Allies for Ottomans?", options:["British", "Crimean Tatars", "French"], a:1},{q:"Condition of Russians?", options:["Strong", "Trapped/Weak", "Reinforced"], a:1},{q:"Result for Pasha?", options:["Promotion", "Lost strength", "Execution"], a:1}]
        },
        {
            title: "Baybars", fileKey: "baybars",
            text: "Baybars was born in Central Asia around 1223. When he was a young boy, enemies captured him and sold him as a slave. He traveled to Egypt to become a Mamluk. Mamluks were special soldier-slaves who went to strict military schools to learn fighting. Baybars trained very hard with horses and weapons. He was smart and strong, so he quickly became an important commander. At this time, a dangerous army called the Mongols was attacking the Middle East. They destroyed many cities and never lost a big battle. In 1260, the Mongols tried to enter Egypt. Baybars met them at a place called Ain Jalut. He used a clever plan to win. He led a small attack and then pretended to run away in fear. The Mongols chased him into a valley without looking carefully. Suddenly, the rest of the Mamluk army appeared from their hiding places. The trap worked perfectly, and they defeated the Mongol army. This victory was very important because it stopped the Mongols from taking the region. Soon after, Baybars became the Sultan of Egypt and Syria. He was a good ruler. He built bridges, canals, and roads to help people travel. He also made a fast mail system using horses. Today, history remembers Baybars as a great leader who protected his people.",
            mcq: [{q:"What were Mamluks?", options:["Farmers", "Soldier-slaves", "Merchant"], a:1},{q:" Mongol defeat site?", options:["Ain Jalut", "Cairo", "Plevna"], a:0},{q:"Tactic used?", options:["Siege", "Pretend retreat", "Fire"], a:1},{q:"Improved system?", options:["Public schools", "Horse mail", "Iron ships"], a:1},{q:"Birth status?", options:["Prince", "Slave", "Merchant"], a:1}]
        },
        {
            title: "Boudica", fileKey: "boudica",
            text: "Boudica was a famous warrior queen in Britain during the first century. At that time, the Roman Empire ruled parts of Britain. The Celtic tribes wanted their freedom. Roman rulers treated the Celtic people harshly. After Boudica's husband, King Prasutagus, died, the Romans took his lands and property. They beat Boudica and attacked her daughters. These cruel actions made Boudica very angry. She decided to fight against Roman rule. Boudica gathered warriors from different Celtic tribes. She became their leader. They attacked Roman towns and forts across eastern Britain. Their most important victories destroyed the cities of Camulodunum, Londinium, and Verulamium. The Roman governor Suetonius led a large army to stop Boudica. At the final battle in 61 AD, the Roman army defeated Boudica's forces, although her army was much larger. The exact details of Boudica's death remain unknown. Some stories say she got ill and died. Other stories say she committed suicide to avoid capture.",
            mcq: [{q:"Empire fought?", options:["Vikings", "Romans", "Greeks"], a:1},{q:"Rebellion trigger?", options:["Tax", "Family mistreatment", "Religion"], a:1},{q:"Destroyed city?", options:["Londinium", "Rome", "Athens"], a:0},{q:"Roman governor?", options:["Nero", "Suetonius", "Caesar"], a:1},{q:"Death status?", options:["In battle", "Suicide/Illness", "Old age"], a:1}]
        },
        {
            title: "Cezzar Ahmed Pasha", fileKey: "cezzar ahmed",
            text: "Cezzar Ahmed Pasha was the Ottoman governor of Acre, a fortress city on the eastern Mediterranean coast. He became famous in 1799, when Napoleon Bonaparte, after conquering Egypt, marched into Syria and attacked Acre. Napoleon was one of the most brilliant generals of his time. He believed Acre would open the road for him to enter Anatolia and perhaps challenge the Ottoman Empire itself. With modern cannons and a strong army, he began a long siege. Although Napoleon‚Äôs army was powerful and had won many victories before, Acre did not fall. Cezzar Ahmed Pasha defended the city with courage and discipline. He was supported by British ships under Admiral Sidney Smith, who gave him weapons and naval help. For two months, Napoleon‚Äôs forces tried again and again, but the walls of Acre resisted. At last, Napoleon abandoned the siege and returned to Egypt. This failure damaged his reputation and stopped his dreams in the East. Cezzar Ahmed Pasha became a hero of the Ottoman Empire, remembered as the man who stopped Napoleon at the gates of Acre.",
            mcq: [{q:"Attacker at Acre?", options:["Peter", "Napoleon", "Eugene"], a:1},{q:"Naval support?", options:["British", "Russian", "French"], a:0},{q:"Duration?", options:["1 week", "2 months", "2 years"], a:1},{q:" Napoleon goal?", options:["Gold", "Enter Anatolia", "Base"], a:1},{q:"Napoleon status after?", options:["Reputation damaged", "Won Sultan", "Crowned"], a:0}]
        },
        {
            title: "El Cid", fileKey: "el cid",
            text: "Rodrigo Diaz de Vivar was born in 1043 near Burgos in Christian Spain. His nickname, 'El Cid,' comes from the Arabic word El Seyit, meaning respected. He grew up as a skilled warrior and served King Sancho II of Castile. He supported the new ruler, King Alfonso VI. But political fights soon made him lose favor. He was accused of treachery and sent into exile. Although he had to leave his king, Rodrigo gathered loyal soldiers and fought to survive. He often worked with Muslim rulers and fought for them when it helped his cause. His respect for Muslim soldiers and leaders made him different from other Christian knights of his time. The most important moment in his life came in 1094, when he took the city of Valencia. Many Muslim families still lived there, and Rodrigo let them stay in the city under his rule. He kept peace with nearby Muslim states and sometimes hired Muslim soldiers to fight for him. His skill in battle and understanding of Muslim customs helped him keep Valencia safe from both Christian and Muslim enemies. Rodrigo continued to defend the city until he died in 1099. His life shows that his Islamic connections, alliances, and respect for Muslim culture were important for his success.",
            mcq: [{q:"Name meaning?", options:["Sword", "Respected", "King"], a:1},{q:"City ruled 1094?", options:["Valencia", "Madrid", "Barcelona"], a:0},{q:"Exile cause?", options:["Treachery", "Old age", "Defeat"], a:0},{q:"Trait?", options:["Respect for Muslims", "No armor", "Sailor"], a:0},{q:"Starting year?", options:["1043", "1094", "1199"], a:0}]
        },
        {
            title: "Fahrettin Pasha", fileKey: "fahrettin",
            text: "Fahrettin Pasha, known as the 'Desert Tiger,' was one of the bravest commanders of the Ottoman Empire. During World War I, in 1916, he was sent to defend the holy city of Medina. His mission was to protect the city against the Arab revolt supported by the British. The famous British spy, Lawrence of Arabia, destroyed the Hejaz Railway and cut Medina off from the world. Food and water became very scarce. Soldiers and people even ate locusts to survive. Still, Fahrettin Pasha never gave up. He sent the holy relics to Istanbul for safety and refused to surrender, saying: 'I will not lower the Turkish flag with my own hands!'. Even after the war ended, he resisted, but was finally forced to give up by his own officers. As he left Medina, he cried: 'O Messenger of God, they are taking me by force!'. Later, he was sent into exile in Egypt and Malta. In 1921, he was freed and joined the Turkish War of Independence. After victory, he became the first ambassador of the new Republic of Turkey in Afghanistan. Fahrettin Pasha died in 1948, but his courage, faith, and love for his country are never forgotten.",
            mcq: [{q:"Nickname?", options:["Iron Lion", "Desert Tiger", "Hero"], a:1},{q:"Survival food?", options:["Bread", "Locusts", "Hide"], a:1},{q:"Railway destroyer?", options:["Lawrence of Arabia", "Townshend", "Smith"], a:0},{q:"Ambassador to?", options:["Russia", "Afghanistan", "Malta"], a:1},{q:"Relics sent to?", options:["Cairo", "Istanbul", "Mecca"], a:1}]
        },
        {
            title: "Gavrilo Princip", fileKey: "gavrilo princip",
            text: "Gavrilo Princip was a young man from Serbia, born in 1894. He lived in Bosnia when it was ruled by the Austro-Hungarian Empire. As a student, he strongly wanted freedom for Slavic peoples. In 1914, something very important happened. Archduke Franz Ferdinand, the next leader of Austria-Hungary, visited Sarajevo. Princip and his friends from a secret group wanted to kill him. Their first plan with a bomb did not work. Later that day, Princip saw the Archduke's car by accident. The driver had made a wrong turn and stopped near him. Princip walked to the car and shot the Archduke and his wife. Both died from their injuries. The police caught Princip right away. Because he was under 20, he could not receive the death penalty. He was sent to prison, where he became sick and died in 1918. The killing of Archduke Franz Ferdinand started a major conflict. Austria-Hungary declared war on Serbia. This led other countries to join the fight, beginning the First World War. People still disagree about Gavrilo Princip today. Some call him a terrorist who caused a terrible war. Others see him as a patriot who fought for his people's freedom.",
            mcq: [{q:"Empire ruling youth?", options:["Ottoman", "Austro-Hungarian", "Russian"], a:1},{q:"Car error?", options:["Broke down", "Wrong turn", "Traffic"], a:1},{q:"War started?", options:["WWII", "WWI", "Crimean"], a:1},{q:"Penalty?", options:["Death", "Prison/illness", "Exile"], a:1},{q:"Age check?", options:["Under 20", "Over 50", "Retired"], a:0}]
        },
        {
            title: "Gazi Osman Pasha", fileKey: "gazi osman",
            text: "Gazi Osman Pasha was a great Ottoman commander... (Full text)... Defense of Plevna in 1877.",
            mcq: [{q:"Defended which town?", options:["Sofia", "Plevna", "Varna"], a:1},{q:"Duration?", options:["5 months", "5 years", "2 weeks"], a:0},{q:"War?", options:["Crimean", "Russo-Turkish", "Balkan"], a:1},{q:"Tactic?", options:["Walls", "Trenches", "Navy"], a:1},{q:"Treatment?", options:["Cruel", "Dignity/Respect", "Ignored"], a:1}]
        },
        {
            title: "Halil Pasha", fileKey: "halil",
            text: "The Siege of Kut al-Amara... (Full text)... 13,000 British prisoners in 1916.",
            mcq: [{q:"Where today?", options:["Turkey", "Iraq", "Egypt"], a:1},{q:"British General?", options:["Smith", "Townshend", "Savoy"], a:1},{q:"Prisoner count?", options:["1,300", "13,000", "130,000"], a:1},{q:"Duration?", options:["47 days", "147 days", "300 days"], a:1},{q:"War?", options:["WWII", "WWI", "Prut"], a:1}]
        },
        {
            title: "isabelle & ferdinand", fileKey: "isabelle & ferdinand",
            text: "Isabella of Castile and Ferdinand of Aragon... (Full text)... 1492 Granada fall and Columbus.",
            mcq: [{q:"Last Muslim city?", options:["Granada", "Madrid", "Barcelona"], a:0},{q:"Explorer?", options:["Polo", "Columbus", "Vasco"], a:1},{q:"United year?", options:["1450", "1469", "1492"], a:1},{q:"Goal?", options:["Reconquista", "Armada", "Colony"], a:0},{q:"Non-Christian choice?", options:["Tax", "Convert/Leave", "Army"], a:1}]
        },
        {
            title: "Jacobi", fileKey: "jacobi",
            text: "Jacobi (Yakup)... (Full text)... Physician who supposedly poisoned Mehmed II.",
            mcq: [{q:"Palace name?", options:["Mehmed", "Yakup", "Jacobi"], a:1},{q:"Role?", options:["Architect", "Physician", "Admiral"], a:1},{q:"Died Sultan?", options:["Murad", "Mehmed II", "Ismail"], a:1},{q:"Masters?", options:["British", "Venice/Vatican", "Spain"], a:1},{q:"Origin?", options:["Near Genoa", "Istanbul", "Rome"], a:0}]
        },
        {
            title: "Koca Sinan Pasha", fileKey: "koca sinan",
            text: "Sinan Pasha... (Full text)... Akƒ±ncƒ± riders destroyed in 1595 Bridge Disaster.",
            mcq: [{q:"Unit destroyed?", options:["Janissary", "Akƒ±ncƒ±", "Mamluk"], a:1},{q:"Delay?", options:["Rain", "Treasure carts", "Broken wheels"], a:1},{q:"Bridge location?", options:["Giurgiu", "Plevna", "Sofia"], a:0},{q:"Enemy?", options:["Michael the Brave", "Eugene", "Peter"], a:0},{q:"Result?", options:["Grew stronger", "Never recovered", "Exiled"], a:1}]
        },
        {
            title: "mezamorta", fileKey: "mezamorta",
            text: "Mezamorta H√ºseyin Pasha... (Full text)... Fired French consul from cannon.",
            mcq: [{q:"Name meaning?", options:["Sea Lion", "Half-dead", "Warrior"], a:1},{q:"Stopped French how?", options:["Burning fleet", "Consul fired from cannon", "Surrender"], a:1},{q:"Ship change?", options:["Rowing to kalyons", "Wood to iron", "Small to large"], a:0},{q:"Winner against?", options:["French", "Venetians", "Spanish"], a:1},{q:"Start?", options:["Pirate/Sailor", "Farmer", "Prince"], a:0}]
        },
        {
            title: "Mir Ali Beg", fileKey: "mir ali beg",
            text: "Mir Ali Beg... (Full text)... Fought Portuguese and cannibal Zimba in Mombasa.",
            mcq: [{q:"Enemy?", options:["Spain", "Portugal", "British"], a:1},{q:"Land attacker?", options:["Zimba cannibals", "Vikings", "Greeks"], a:0},{q:"Fate?", options:["Escaped", "Prisoner in Portugal", "Sultan"], a:1},{q:"Port?", options:["Mombasa", "Cairo", "Algiers"], a:0},{q:"Region?", options:["North Africa", "East Africa", "India"], a:1}]
        },
        {
            title: "Mustafa 'the second'", fileKey: "mustafa the second",
            text: "Mustafa II... (Full text)... 30,000 Ottomans lost at Tisa River bridge.",
            mcq: [{q:"General?", options:["Smith", "Prince Eugene", "Townshend"], a:1},{q:"Delay cause?", options:["Storm", "Pashas/Money", "Snow"], a:1},{q:"Treaty?", options:["Prut", "Karlowitz", "Acre"], a:1},{q:"Losses?", options:["3,000", "30,000", "100,000"], a:1},{q:"Seal loss?", options:["Sword", "Seal", "Crown"], a:1}]
        },
        {
            title: "ragnar lodbrok", fileKey: "ragnar lodbrok",
            text: "Ragnar Lodbrok... (Full text)... Died in a snake pit in England.",
            mcq: [{q:"Name?", options:["Hairy pants", "Fast boat", "King"], a:0},{q:"City silver?", options:["London", "Paris", "Rome"], a:1},{q:"Death?", options:["Battle", "Snake pit", "Old age"], a:1},{q:"Sons group?", options:["Heathen Army", "Legion", "Akƒ±ncƒ±"], a:0},{q:"Avenged on?", options:["Nero", "King Aella", "Eugene"], a:1}]
        },
        {
            title: "Rob Roy", fileKey: "rob roy",
            text: "Rob Roy... (Full text)... Scottish Robin Hood cattle outlaw.",
            mcq: [{q:"Job?", options:["Soldier", "Cattle farmer", "Sailor"], a:1},{q:"Nickname?", options:["Scot", "Robin Hood", "King"], a:1},{q:"Outlaw cause?", options:["Stole crown", "Lost land/Debt", "Old age"], a:1},{q:"Hideout?", options:["London", "Highlands", "Cave"], a:1},{q:"Clan?", options:["MacGregor", "Stewart", "Aella"], a:0}]
        },
        {
            title: "salahuddin eyyubi", fileKey: "salahuddin eyyubi",
            text: "Saladin... (Full text)... Captured Jerusalem fairly in 1187.",
            mcq: [{q:"Born?", options:["Cairo", "Tikrit", "Baghdad"], a:1},{q:"1187?", options:["Jerusalem capture", "Birth", "Death"], a:0},{q:"Battle win?", options:["Jalut", "Hattin", "Plevna"], a:1},{q:"Jerusalem trait?", options:["Cruelty", "Fairness/Respect", "Gold"], a:1},{q:"Goal?", options:["Conquer Rome", "Unite Muslims", "Build wall"], a:1}]
        },
        {
            title: "Skanderbeg", fileKey: "skanderbeg",
            text: "Skanderbeg (Gjergj Kastrioti)... (Full text)... National hero of Albania.",
            mcq: [{q:"Real name?", options:["Mehmet", "Gjergj Kastrioti", "Osman"], a:1},{q:"Flag symbol?", options:["Lion", "Double-headed eagle", "Moon"], a:1},{q:"Resistance time?", options:["2", "20", "50 years"], a:1},{q:"Pope title?", options:["Athlete of Christ", "Saint", "King"], a:0},{q:"Trained?", options:["Rome", "Ottoman Empire", "Paris"], a:1}]
        },
        {
            title: "Spartacus", fileKey: "spartacus",
            text: "Spartacus... (Full text)... Led 73 BC slave revolt against Rome.",
            mcq: [{q:"Origin?", options:["Rome", "Thrace", "Egypt"], a:1},{q:"Escape tool?", options:["Swords", "Kitchen knives", "Chains"], a:1},{q:"Hideout?", options:["Forum", "Mount Vesuvius", "Colosseum"], a:1},{q:"Defeated by?", options:["Caesar", "Crassus", "Napoleon"], a:1},{q:"Penalty?", options:["Crucified", "Free", "Exiled"], a:0}]
        },
        {
            title: "stefan dusan", fileKey: "stefan dusan",
            text: "Stefan Du≈°an ruled Serbia... (Full text)... 1331-1355 empire builder.",
            mcq: [{q:"Goal?", options:["Rome", "Constantinople", "London"], a:1},{q:"Threat?", options:["Vikings", "Ottomans", "British"], a:1},{q:"Alliance?", options:["France", "Pope/Venice", "Russia"], a:1},{q:"Post-death status?", options:["Stronger", "Weakened/Divided", "Stable"], a:1},{q:"Maritsa timing?", options:["34 years after death", "Immediately", "100 years"], a:0}]
        },
        {
            title: "Taras Bulba", fileKey: "taras bulba",
            text: "Taras Bulba... (Full text)... Killed son Andriy for betraying Cossacks.",
            mcq: [{q:"Who fought?", options:["Russia", "Poland", "Germany"], a:1},{q:"Why kill son?", options:["Stealing", "Enemy betrayal/Love", "Cowardice"], a:1},{q:"Ostap killed where?", options:["Kyiv", "Warsaw", "London"], a:1},{q:"Line?", options:["Go", "I gave life, take it", "I hate you"], a:1},{q:"Group?", options:["Viking", "Cossack", "Mamluk"], a:1}]
        },
        {
            title: "tariq ibn ziyad", fileKey: "tariq ibn ziyad",
            text: "Tariq ibn Ziyad... (Full text)... Burned boats at Gibraltar in 711 AD.",
            mcq: [{q:"Place name?", options:["Alps", "Gibraltar", "Madrid"], a:1},{q:"Boat order?", options:["Build", "Burn", "Sell"], a:1},{q:"King defeated?", options:["Philip", "Roderick", "Alexander"], a:1},{q:"Rule length?", options:["8", "800", "8,000 years"], a:1},{q:"Year?", options:["711 AD", "1000", "1492"], a:0}]
        },
        {
            title: "timur", fileKey: "timur",
            text: "Timur captured Bayezid at Ankara... (Full text)... 1402 conqueror.",
            mcq: [{q:"Sultan captured?", options:["Mehmet", "Bayezid", "Mustafa"], a:1},{q:"Ankara tactic?", options:["Cannons", "Switch sides", "Night"], a:1},{q:"Invade target?", options:["Egypt", "China", "India"], a:1},{q:"Died?", options:["1336", "1405", "1492"], a:1},{q:"Sultan result?", options:["Freed", "Died prisoner", "Escaped"], a:1}]
        },
        {
            title: "Tomyris", fileKey: "tomyris",
            text: "Queen Tomyris... (Full text)... Bag of blood revenge on Cyrus the Great.",
            mcq: [{q:"King defeated?", options:["Xerxes", "Cyrus the Great", "Darius"], a:1},{q:"Trick used?", options:["Wine/food camp", "Fake peace", "Spies"], a:0},{q:"Head fate?", options:["Sent to Rome", "Bag of blood", "Buried"], a:1},{q:"Son's death?", options:["Battle", "Suicide/Capture", "Old age"], a:1},{q:"Location?", options:["Egypt", "Central Asia", "France"], a:1}]
        },
        {
            title: "Turgut Reis", fileKey: "turgut reis",
            text: "Turgut Reis... (Full text)... Move ships overland at Djerba.",
            mcq: [{q:"Rescuer?", options:["Suleiman", "Barbarossa", "Yusuf"], a:1},{q:"Djerba escape?", options:["Swim", "Overland ships", "Storm"], a:1},{q:"Where died?", options:["Vienna", "Malta", "Acre"], a:1},{q:"Prisoner length?", options:["1 month", "3 years", "10 years"], a:1},{q:"Tomb?", options:["Istanbul", "Tripoli", "Malta"], a:1}]
        },
        {
            title: "vlad dracula", fileKey: "vlad dracula",
            text: "Vlad the Impaler... (Full text)... Hostage in Ottoman palace.",
            mcq: [{q:"Meaning?", options:["Impaler", "Son of dragon", "King"], a:1},{q:"Hostage where?", options:["Rome", "Ottoman Empire", "Paris"], a:1},{q:"Brother?", options:["Radu", "Mustafa", "Stefan"], a:0},{q:"Tactic?", options:["Scorched earth", "Wall", "Bribe"], a:0},{q:"Head sent to?", options:["Philip", "Mehmed II", "Pope"], a:1}]
        },
        {
            title: "William Tell", fileKey: "william tell",
            text: "William Tell... (Full text)... Shot apple off son's head.",
            mcq: [{q:"Target?", options:["Bird", "Apple on son's head", "Target"], a:1},{q:"2nd arrow for?", options:["Son", "Gessler", "King"], a:1},{q:"Escape method?", options:["Swam", "Steering in storm", "Bribe"], a:1},{q:"On pole?", options:["Sword", "Hat", "Crown"], a:1},{q:"Nation?", options:["Scotland", "Switzerland", "Albania"], a:1}]
        },
        {
            title: "William Wallace", fileKey: "william wallace",
            text: "William Wallace... (Full text)... 1297 Stirling Bridge victory.",
            mcq: [{q:"King?", options:["Henry", "Edward I", "Richard"], a:1},{q:"Victory?", options:["Falkirk", "Stirling Bridge", "London"], a:1},{q:"Trigger?", options:["Gold", "Wife killed", "Taxes"], a:1},{q:"Execution city?", options:["Edinburgh", "London", "Paris"], a:1},{q:"Successor?", options:["Bruce", "Rob Roy", "Eugene"], a:0}]
        },
        {
            title: "Yusuf Pasha", fileKey: "yusuf pasha",
            text: "Yusuf Pasha... (Full text)... 1788 confusion won victory over Austrians.",
            mcq: [{q:"Cause?", options:["Plague", "Alcohol/Confusion", "Storm"], a:1},{q:"Mistaken word?", options:["Halt!", "Attack!", "Run!"], a:0},{q:"Army size?", options:["10,000", "100,000", "500,000"], a:1},{q:"Country?", options:["Turkey", "Romania", "Germany"], a:1},{q:"Effort?", options:["Siege", "None", "1-day fight"], a:1}]
        }
    ];

    let currentMode = 'listen'; let isSlowMode = false; let repoFiles = [];
    const player = document.getElementById('player'); const list = document.getElementById('list');

    // NORM ENGINE: Force standard spelling for perfect matching
    function norm(str) { 
        if(!str) return "";
        return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase().replace(" and ", " & ").replace(" pasha", "").trim(); 
    }

    async function fetchFiles() {
        try {
            const res = await fetch("https://api.github.com/repos/dogierez01/historic-people/contents/");
            const data = await res.json();
            repoFiles = data.map(f => f.name);
            renderList();
        } catch (e) { renderList(); }
    }
    fetchFiles();

    function startApp() { document.getElementById('splash-screen').style.display = 'none'; }

    function renderList() {
        const sorted = [...db].sort((a, b) => a.title.localeCompare(b.title));
        list.innerHTML = sorted.map((item) => {
            const originalIndex = db.findIndex(x => x.title === item.title);
            if (currentMode === 'listen') {
                return `<div class="card" data-name="${item.title.toLowerCase()}">
                    <div class="card-title">${item.title}</div>
                    <button class="listen-btn btn-uk" onclick="playHP(${originalIndex},'uk')">üá¨üáß 1. UK English</button>
                    <button class="listen-btn btn-us-f" onclick="playHP(${originalIndex},'female')">üá∫üá∏ 2. US Female</button>
                    <button class="listen-btn btn-us-m" onclick="openRead(${originalIndex})">üìñ 3. Read & Listen (US Male)</button>
                </div>`;
            } else {
                return `<button class="quiz-menu-btn" data-name="${item.title.toLowerCase()}" onclick="openQuiz(${originalIndex})">üß† ${item.title} Quiz</button>`;
            }
        }).join('');
    }

    function playHP(idx, type) {
        const item = db[idx];
        const BASE = "https://raw.githubusercontent.com/dogierez01/historic-people/main/";
        
        let searchKey = norm(item.fileKey); 
        let file = "";
        
        if (type === 'uk') file = repoFiles.find(f => norm(f).includes(searchKey) && norm(f).includes('uk'));
        else if (type === 'female') file = repoFiles.find(f => norm(f).includes(searchKey) && norm(f).includes('us') && norm(f).includes('female'));
        else if (type === 'male') {
            // HARD-WIRED MALE FIX: Strictly exclude "female"
            file = repoFiles.find(f => norm(f).includes(searchKey) && norm(f).includes('us') && norm(f).includes('male') && !norm(f).includes('female'));
        }
        
        if (file) { 
            player.src = BASE + encodeURIComponent(file); 
            player.playbackRate = isSlowMode ? 0.8 : 1.0; 
            player.play(); 
        }
    }

    function openRead(i) {
        document.getElementById('story-text').innerText = db[i].text;
        document.getElementById('view-listen').style.display = 'block';
        document.getElementById('view-quiz').style.display = 'none';
        document.getElementById('modal').style.display = 'block';
        playHP(i, 'male');
    }

    function openQuiz(i) {
        document.getElementById('quiz-title').innerText = db[i].title + " MCQ Quiz";
        document.getElementById('quiz-area').innerHTML = db[i].mcq.map((q, qIdx) => `
            <div class="quiz-q"><div class="q-text">Q${qIdx+1}: ${q.q}</div>
            ${q.options.map((opt, oIdx) => `<button class="mcq-option" onclick="checkMCQ(this, ${q.a}, ${oIdx})">${opt}</button>`).join('')}
            <div class="feedback"></div></div>`).join('');
        document.getElementById('view-listen').style.display = 'none';
        document.getElementById('view-quiz').style.display = 'block';
        document.getElementById('modal').style.display = 'block';
    }

    function checkMCQ(btn, correctIdx, userIdx) {
        const parent = btn.parentElement;
        const fb = parent.querySelector('.feedback');
        if (correctIdx === userIdx) {
            fb.innerHTML = "<span class='correct'>‚úì CORRECT!</span>";
            btn.style.backgroundColor = "#2f9e44";
        } else {
            fb.innerHTML = "<span class='wrong'>‚úó WRONG!</span>";
            btn.style.backgroundColor = "#d63031";
        }
        parent.querySelectorAll('.mcq-option').forEach(b => b.disabled = true);
    }

    function setMode(m) { 
        currentMode = m; 
        document.getElementById('btn-listen').className = (m==='listen')?'toggle-btn active':'toggle-btn';
        document.getElementById('btn-quiz').className = (m==='quiz')?'toggle-btn active':'toggle-btn';
        renderList(); 
    }
    function closeModal() { document.getElementById('modal').style.display = 'none'; player.pause(); }
    function toggleSnail() { isSlowMode = !isSlowMode; player.playbackRate = isSlowMode ? 0.8 : 1.0; document.getElementById('btn-snail').classList.toggle('active'); }
    function filterList() {
        const val = document.getElementById('search').value.toLowerCase();
        document.querySelectorAll('.card, .quiz-menu-btn').forEach(el => {
            el.style.display = el.getAttribute('data-name').includes(val) ? 'block' : 'none';
        });
    }
</script>
</body>
</html>
